import{r as h}from"./vendor-bn.js-CN51n21Z.js";import{r as g}from"./vendor-randombytes-ndKo2FAH.js";import{r as x}from"./vendor-safe-buffer-BPihLaHX.js";var u,i;function A(){if(i)return u;i=1;var n=h(),f=g(),l=x().Buffer;function m(e){var r=e.modulus.byteLength(),o;do o=new n(f(r));while(o.cmp(e.modulus)>=0||!o.umod(e.prime1)||!o.umod(e.prime2));return o}function s(e){var r=m(e),o=r.toRed(n.mont(e.modulus)).redPow(new n(e.publicExponent)).fromRed();return{blinder:o,unblinder:r.invm(e.modulus)}}function d(e,r){var o=s(r),b=r.modulus.byteLength(),a=new n(e).mul(o.blinder).umod(r.modulus),c=a.toRed(n.mont(r.prime1)),w=a.toRed(n.mont(r.prime2)),R=r.coefficient,B=r.prime1,q=r.prime2,y=c.redPow(r.exponent1).fromRed(),t=w.redPow(r.exponent2).fromRed(),v=y.isub(t).imul(R).umod(B).imul(q);return t.iadd(v).imul(o.unblinder).umod(r.modulus).toArrayLike(l,"be",b)}return d.getr=m,u=d,u}export{A as r};
