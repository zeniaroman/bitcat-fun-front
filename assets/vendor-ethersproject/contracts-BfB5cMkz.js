import{I as T,a as D,c as k}from"./abi-BZPj2eRn.js";import{P as I}from"./abstract-provider-BJATZ19F.js";import{S as G,V as F}from"./abstract-signer-vaofOY7d.js";import{g as w,a as j}from"./address-C-94Rlzo.js";import{g as $,i as q,a as z}from"./bytes-BFUO92dS.js";import{d as l,g as H,s as E,a as x,r as P}from"./properties-Bism-GXA.js";import{L as h}from"./logger-BIOSViGG.js";import{B as g}from"./bignumber-DuyZ-PBD.js";const V="transactions/5.8.0",C=new h(V);var L;(function(s){s[s.legacy=0]="legacy",s[s.eip2930=1]="eip2930",s[s.eip1559=2]="eip1559"})(L||(L={}));function A(s,e){return{address:w(s),storageKeys:(e||[]).map((t,r)=>($(t)!==32&&C.throwArgumentError("invalid access list storageKey",`accessList[${s}:${r}]`,t),t.toLowerCase()))}}function K(s){if(Array.isArray(s))return s.map((t,r)=>Array.isArray(t)?(t.length>2&&C.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${r}]`,t),A(t[0],t[1])):A(t.address,t.storageKeys));const e=Object.keys(s).map(t=>{const r=s[t].reduce((n,d)=>(n[d]=!0,n),{});return A(t,Object.keys(r).sort())});return e.sort((t,r)=>t.address.localeCompare(r.address)),e}const J="contracts/5.8.0";var v=function(s,e,t,r){function n(d){return d instanceof t?d:new t(function(i){i(d)})}return new(t||(t=Promise))(function(d,i){function o(f){try{u(r.next(f))}catch(p){i(p)}}function a(f){try{u(r.throw(f))}catch(p){i(p)}}function u(f){f.done?d(f.value):n(f.value).then(o,a)}u((r=r.apply(s,e||[])).next())})};const c=new h(J);function _(s,e){return v(this,void 0,void 0,function*(){const t=yield e;typeof t!="string"&&c.throwArgumentError("invalid address or ENS name","name",t);try{return w(t)}catch{}s||c.throwError("a provider or signer is needed to resolve ENS names",h.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const r=yield s.resolveName(t);return r==null&&c.throwArgumentError("resolver or addr is not configured for ENS name","name",t),r})}function y(s,e,t){return v(this,void 0,void 0,function*(){return Array.isArray(t)?yield Promise.all(t.map((r,n)=>y(s,Array.isArray(e)?e[n]:e[r.name],r))):t.type==="address"?yield _(s,e):t.type==="tuple"?yield y(s,e,t.components):t.baseType==="array"?Array.isArray(e)?yield Promise.all(e.map(r=>y(s,r,t.arrayChildren))):Promise.reject(c.makeError("invalid value for array",h.errors.INVALID_ARGUMENT,{argument:"value",value:e})):e})}function R(s,e,t){return v(this,void 0,void 0,function*(){let r={};t.length===e.inputs.length+1&&typeof t[t.length-1]=="object"&&(r=E(t.pop())),c.checkArgumentCount(t.length,e.inputs.length,"passed to contract"),s.signer?r.from?r.from=P({override:_(s.signer,r.from),signer:s.signer.getAddress()}).then(u=>v(this,void 0,void 0,function*(){return w(u.signer)!==u.override&&c.throwError("Contract with a Signer cannot override from",h.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),u.override})):r.from=s.signer.getAddress():r.from&&(r.from=_(s.provider,r.from));const n=yield P({args:y(s.signer||s.provider,t,e.inputs),address:s.resolvedAddress,overrides:P(r)||{}}),d=s.interface.encodeFunctionData(e,n.args),i={data:d,to:n.address},o=n.overrides;if(o.nonce!=null&&(i.nonce=g.from(o.nonce).toNumber()),o.gasLimit!=null&&(i.gasLimit=g.from(o.gasLimit)),o.gasPrice!=null&&(i.gasPrice=g.from(o.gasPrice)),o.maxFeePerGas!=null&&(i.maxFeePerGas=g.from(o.maxFeePerGas)),o.maxPriorityFeePerGas!=null&&(i.maxPriorityFeePerGas=g.from(o.maxPriorityFeePerGas)),o.from!=null&&(i.from=o.from),o.type!=null&&(i.type=o.type),o.accessList!=null&&(i.accessList=K(o.accessList)),i.gasLimit==null&&e.gas!=null){let u=21e3;const f=z(d);for(let p=0;p<f.length;p++)u+=4,f[p]&&(u+=64);i.gasLimit=g.from(e.gas).add(u)}if(o.value){const u=g.from(o.value);!u.isZero()&&!e.payable&&c.throwError("non-payable method cannot override value",h.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:r.value}),i.value=u}o.customData&&(i.customData=E(o.customData)),o.ccipReadEnabled&&(i.ccipReadEnabled=!!o.ccipReadEnabled),delete r.nonce,delete r.gasLimit,delete r.gasPrice,delete r.from,delete r.value,delete r.type,delete r.accessList,delete r.maxFeePerGas,delete r.maxPriorityFeePerGas,delete r.customData,delete r.ccipReadEnabled;const a=Object.keys(r).filter(u=>r[u]!=null);return a.length&&c.throwError(`cannot override ${a.map(u=>JSON.stringify(u)).join(",")}`,h.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:a}),i})}function W(s,e){return function(...t){return R(s,e,t)}}function B(s,e){const t=s.signer||s.provider;return function(...r){return v(this,void 0,void 0,function*(){t||c.throwError("estimate require a provider or signer",h.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const n=yield R(s,e,r);return yield t.estimateGas(n)})}}function M(s,e){const t=e.wait.bind(e);e.wait=r=>t(r).then(n=>(n.events=n.logs.map(d=>{let i=x(d),o=null;try{o=s.interface.parseLog(d)}catch{}return o&&(i.args=o.args,i.decode=(a,u)=>s.interface.decodeEventLog(o.eventFragment,a,u),i.event=o.name,i.eventSignature=o.signature),i.removeListener=()=>s.provider,i.getBlock=()=>s.provider.getBlock(n.blockHash),i.getTransaction=()=>s.provider.getTransaction(n.transactionHash),i.getTransactionReceipt=()=>Promise.resolve(n),i}),n))}function N(s,e,t){const r=s.signer||s.provider;return function(...n){return v(this,void 0,void 0,function*(){let d;if(n.length===e.inputs.length+1&&typeof n[n.length-1]=="object"){const a=E(n.pop());a.blockTag!=null&&(d=yield a.blockTag),delete a.blockTag,n.push(a)}s.deployTransaction!=null&&(yield s._deployed(d));const i=yield R(s,e,n),o=yield r.call(i,d);try{let a=s.interface.decodeFunctionResult(e,o);return t&&e.outputs.length===1&&(a=a[0]),a}catch(a){throw a.code===h.errors.CALL_EXCEPTION&&(a.address=s.address,a.args=n,a.transaction=i),a}})}}function X(s,e){return function(...t){return v(this,void 0,void 0,function*(){s.signer||c.throwError("sending a transaction requires a signer",h.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),s.deployTransaction!=null&&(yield s._deployed());const r=yield R(s,e,t),n=yield s.signer.sendTransaction(r);return M(s,n),n})}}function b(s,e,t){return e.constant?N(s,e,t):X(s,e)}function U(s){return s.address&&(s.topics==null||s.topics.length===0)?"*":(s.address||"*")+"@"+(s.topics?s.topics.map(e=>Array.isArray(e)?e.join("|"):e).join(":"):"")}class m{constructor(e,t){l(this,"tag",e),l(this,"filter",t),this._listeners=[]}addListener(e,t){this._listeners.push({listener:e,once:t})}removeListener(e){let t=!1;this._listeners=this._listeners.filter(r=>t||r.listener!==e?!0:(t=!0,!1))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map(e=>e.listener)}listenerCount(){return this._listeners.length}run(e){const t=this.listenerCount();return this._listeners=this._listeners.filter(r=>{const n=e.slice();return setTimeout(()=>{r.listener.apply(this,n)},0),!r.once}),t}prepareEvent(e){}getEmit(e){return[e]}}class Z extends m{constructor(){super("error",null)}}class S extends m{constructor(e,t,r,n){const d={address:e};let i=t.getEventTopic(r);n?(i!==n[0]&&c.throwArgumentError("topic mismatch","topics",n),d.topics=n.slice()):d.topics=[i],super(U(d),d),l(this,"address",e),l(this,"interface",t),l(this,"fragment",r)}prepareEvent(e){super.prepareEvent(e),e.event=this.fragment.name,e.eventSignature=this.fragment.format(),e.decode=(t,r)=>this.interface.decodeEventLog(this.fragment,t,r);try{e.args=this.interface.decodeEventLog(this.fragment,e.data,e.topics)}catch(t){e.args=null,e.decodeError=t}}getEmit(e){const t=k(e.args);if(t.length)throw t[0].error;const r=(e.args||[]).slice();return r.push(e),r}}class O extends m{constructor(e,t){super("*",{address:e}),l(this,"address",e),l(this,"interface",t)}prepareEvent(e){super.prepareEvent(e);try{const t=this.interface.parseLog(e);e.event=t.name,e.eventSignature=t.signature,e.decode=(r,n)=>this.interface.decodeEventLog(t.eventFragment,r,n),e.args=t.args}catch{}}}class Q{constructor(e,t,r){l(this,"interface",H(new.target,"getInterface")(t)),r==null?(l(this,"provider",null),l(this,"signer",null)):G.isSigner(r)?(l(this,"provider",r.provider||null),l(this,"signer",r)):I.isProvider(r)?(l(this,"provider",r),l(this,"signer",null)):c.throwArgumentError("invalid signer or provider","signerOrProvider",r),l(this,"callStatic",{}),l(this,"estimateGas",{}),l(this,"functions",{}),l(this,"populateTransaction",{}),l(this,"filters",{});{const i={};Object.keys(this.interface.events).forEach(o=>{const a=this.interface.events[o];l(this.filters,o,(...u)=>({address:this.address,topics:this.interface.encodeFilterTopics(a,u)})),i[a.name]||(i[a.name]=[]),i[a.name].push(o)}),Object.keys(i).forEach(o=>{const a=i[o];a.length===1?l(this.filters,o,this.filters[a[0]]):c.warn(`Duplicate definition of ${o} (${a.join(", ")})`)})}if(l(this,"_runningEvents",{}),l(this,"_wrappedEmits",{}),e==null&&c.throwArgumentError("invalid contract address or ENS name","addressOrName",e),l(this,"address",e),this.provider)l(this,"resolvedAddress",_(this.provider,e));else try{l(this,"resolvedAddress",Promise.resolve(w(e)))}catch{c.throwError("provider is required to use ENS name as contract address",h.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch(i=>{});const n={},d={};Object.keys(this.interface.functions).forEach(i=>{const o=this.interface.functions[i];if(d[i]){c.warn(`Duplicate ABI entry for ${JSON.stringify(i)}`);return}d[i]=!0;{const a=o.name;n[`%${a}`]||(n[`%${a}`]=[]),n[`%${a}`].push(i)}this[i]==null&&l(this,i,b(this,o,!0)),this.functions[i]==null&&l(this.functions,i,b(this,o,!1)),this.callStatic[i]==null&&l(this.callStatic,i,N(this,o,!0)),this.populateTransaction[i]==null&&l(this.populateTransaction,i,W(this,o)),this.estimateGas[i]==null&&l(this.estimateGas,i,B(this,o))}),Object.keys(n).forEach(i=>{const o=n[i];if(o.length>1)return;i=i.substring(1);const a=o[0];try{this[i]==null&&l(this,i,this[a])}catch{}this.functions[i]==null&&l(this.functions,i,this.functions[a]),this.callStatic[i]==null&&l(this.callStatic,i,this.callStatic[a]),this.populateTransaction[i]==null&&l(this.populateTransaction,i,this.populateTransaction[a]),this.estimateGas[i]==null&&l(this.estimateGas,i,this.estimateGas[a])})}static getContractAddress(e){return j(e)}static getInterface(e){return T.isInterface(e)?e:new T(e)}deployed(){return this._deployed()}_deployed(e){return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then(()=>this):this._deployedPromise=this.provider.getCode(this.address,e).then(t=>(t==="0x"&&c.throwError("contract not deployed",h.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this))),this._deployedPromise}fallback(e){this.signer||c.throwError("sending a transactions require a signer",h.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const t=E(e||{});return["from","to"].forEach(function(r){t[r]!=null&&c.throwError("cannot override "+r,h.errors.UNSUPPORTED_OPERATION,{operation:r})}),t.to=this.resolvedAddress,this.deployed().then(()=>this.signer.sendTransaction(t))}connect(e){typeof e=="string"&&(e=new F(e,this.provider));const t=new this.constructor(this.address,this.interface,e);return this.deployTransaction&&l(t,"deployTransaction",this.deployTransaction),t}attach(e){return new this.constructor(e,this.interface,this.signer||this.provider)}static isIndexed(e){return D.isIndexed(e)}_normalizeRunningEvent(e){return this._runningEvents[e.tag]?this._runningEvents[e.tag]:e}_getRunningEvent(e){if(typeof e=="string"){if(e==="error")return this._normalizeRunningEvent(new Z);if(e==="event")return this._normalizeRunningEvent(new m("event",null));if(e==="*")return this._normalizeRunningEvent(new O(this.address,this.interface));const t=this.interface.getEvent(e);return this._normalizeRunningEvent(new S(this.address,this.interface,t))}if(e.topics&&e.topics.length>0){try{const r=e.topics[0];if(typeof r!="string")throw new Error("invalid topic");const n=this.interface.getEvent(r);return this._normalizeRunningEvent(new S(this.address,this.interface,n,e.topics))}catch{}const t={address:this.address,topics:e.topics};return this._normalizeRunningEvent(new m(U(t),t))}return this._normalizeRunningEvent(new O(this.address,this.interface))}_checkRunningEvents(e){if(e.listenerCount()===0){delete this._runningEvents[e.tag];const t=this._wrappedEmits[e.tag];t&&e.filter&&(this.provider.off(e.filter,t),delete this._wrappedEmits[e.tag])}}_wrapEvent(e,t,r){const n=x(t);return n.removeListener=()=>{r&&(e.removeListener(r),this._checkRunningEvents(e))},n.getBlock=()=>this.provider.getBlock(t.blockHash),n.getTransaction=()=>this.provider.getTransaction(t.transactionHash),n.getTransactionReceipt=()=>this.provider.getTransactionReceipt(t.transactionHash),e.prepareEvent(n),n}_addEventListener(e,t,r){if(this.provider||c.throwError("events require a provider or a signer with a provider",h.errors.UNSUPPORTED_OPERATION,{operation:"once"}),e.addListener(t,r),this._runningEvents[e.tag]=e,!this._wrappedEmits[e.tag]){const n=d=>{let i=this._wrapEvent(e,d,t);if(i.decodeError==null)try{const o=e.getEmit(i);this.emit(e.filter,...o)}catch(o){i.decodeError=o.error}e.filter!=null&&this.emit("event",i),i.decodeError!=null&&this.emit("error",i.decodeError,i)};this._wrappedEmits[e.tag]=n,e.filter!=null&&this.provider.on(e.filter,n)}}queryFilter(e,t,r){const n=this._getRunningEvent(e),d=E(n.filter);return typeof t=="string"&&q(t,32)?(r!=null&&c.throwArgumentError("cannot specify toBlock with blockhash","toBlock",r),d.blockHash=t):(d.fromBlock=t??0,d.toBlock=r??"latest"),this.provider.getLogs(d).then(i=>i.map(o=>this._wrapEvent(n,o,null)))}on(e,t){return this._addEventListener(this._getRunningEvent(e),t,!1),this}once(e,t){return this._addEventListener(this._getRunningEvent(e),t,!0),this}emit(e,...t){if(!this.provider)return!1;const r=this._getRunningEvent(e),n=r.run(t)>0;return this._checkRunningEvents(r),n}listenerCount(e){return this.provider?e==null?Object.keys(this._runningEvents).reduce((t,r)=>t+this._runningEvents[r].listenerCount(),0):this._getRunningEvent(e).listenerCount():0}listeners(e){if(!this.provider)return[];if(e==null){const t=[];for(let r in this._runningEvents)this._runningEvents[r].listeners().forEach(n=>{t.push(n)});return t}return this._getRunningEvent(e).listeners()}removeAllListeners(e){if(!this.provider)return this;if(e==null){for(const r in this._runningEvents){const n=this._runningEvents[r];n.removeAllListeners(),this._checkRunningEvents(n)}return this}const t=this._getRunningEvent(e);return t.removeAllListeners(),this._checkRunningEvents(t),this}off(e,t){if(!this.provider)return this;const r=this._getRunningEvent(e);return r.removeListener(t),this._checkRunningEvents(r),this}removeListener(e,t){return this.off(e,t)}}class ae extends Q{}export{ae as C};
