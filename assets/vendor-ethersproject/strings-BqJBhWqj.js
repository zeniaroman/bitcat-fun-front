import{a as p}from"./bytes-BFUO92dS.js";import{L as s}from"./logger-BIOSViGG.js";const a="strings/5.8.0",N=new s(a);var l;(function(e){e.current="",e.NFC="NFC",e.NFD="NFD",e.NFKC="NFKC",e.NFKD="NFKD"})(l||(l={}));var r;(function(e){e.UNEXPECTED_CONTINUE="unexpected continuation byte",e.BAD_PREFIX="bad codepoint prefix",e.OVERRUN="string overrun",e.MISSING_CONTINUE="missing continuation byte",e.OUT_OF_RANGE="out of UTF-8 range",e.UTF16_SURROGATE="UTF-16 surrogate",e.OVERLONG="overlong representation"})(r||(r={}));function C(e,t,n,f,u){return N.throwArgumentError(`invalid codepoint at offset ${t}; ${e}`,"bytes",n)}function g(e,t,n,f,u){if(e===r.BAD_PREFIX||e===r.UNEXPECTED_CONTINUE){let i=0;for(let x=t+1;x<n.length&&n[x]>>6===2;x++)i++;return i}return e===r.OVERRUN?n.length-t-1:0}function O(e,t,n,f,u){return e===r.OVERLONG?(f.push(u),0):(f.push(65533),g(e,t,n))}const F=Object.freeze({error:C,ignore:g,replace:O});function E(e,t){t==null&&(t=F.error),e=p(e);const n=[];let f=0;for(;f<e.length;){const u=e[f++];if(u>>7===0){n.push(u);continue}let i=null,x=null;if((u&224)===192)i=1,x=127;else if((u&240)===224)i=2,x=2047;else if((u&248)===240)i=3,x=65535;else{(u&192)===128?f+=t(r.UNEXPECTED_CONTINUE,f-1,e,n):f+=t(r.BAD_PREFIX,f-1,e,n);continue}if(f-1+i>=e.length){f+=t(r.OVERRUN,f-1,e,n);continue}let c=u&(1<<8-i-1)-1;for(let o=0;o<i;o++){let h=e[f];if((h&192)!=128){f+=t(r.MISSING_CONTINUE,f,e,n),c=null;break}c=c<<6|h&63,f++}if(c!==null){if(c>1114111){f+=t(r.OUT_OF_RANGE,f-1-i,e,n,c);continue}if(c>=55296&&c<=57343){f+=t(r.UTF16_SURROGATE,f-1-i,e,n,c);continue}if(c<=x){f+=t(r.OVERLONG,f-1-i,e,n,c);continue}n.push(c)}}return n}function _(e,t=l.current){t!=l.current&&(N.checkNormalize(),e=e.normalize(t));let n=[];for(let f=0;f<e.length;f++){const u=e.charCodeAt(f);if(u<128)n.push(u);else if(u<2048)n.push(u>>6|192),n.push(u&63|128);else if((u&64512)==55296){f++;const i=e.charCodeAt(f);if(f>=e.length||(i&64512)!==56320)throw new Error("invalid utf-8 string");const x=65536+((u&1023)<<10)+(i&1023);n.push(x>>18|240),n.push(x>>12&63|128),n.push(x>>6&63|128),n.push(x&63|128)}else n.push(u>>12|224),n.push(u>>6&63|128),n.push(u&63|128)}return p(n)}function U(e){return e.map(t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10&1023)+55296,(t&1023)+56320))).join("")}function R(e,t){return U(E(e,t))}export{l as U,R as a,_ as t};
