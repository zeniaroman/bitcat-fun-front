import{a as Je}from"./solana-vendors-DGPAp7Fj.js";import{r as St}from"./vendor-inherits-BICa84dG.js";import{r as ae}from"./vendor-buffer-DVXvU5G6.js";import{r as Ve}from"./vendor-minimalistic-assert-OF9c2MWr.js";const Ye={},We=Object.freeze(Object.defineProperty({__proto__:null,default:Ye},Symbol.toStringTag,{value:"Module"})),$e=Je(We);var Yt={},Dt={exports:{}},Qe=Dt.exports,qe;function Xe(){return qe||(qe=1,function(R){(function(x,D){function m(l,t){if(!l)throw new Error(t||"Assertion failed")}function b(l,t){l.super_=t;var r=function(){};r.prototype=t.prototype,l.prototype=new r,l.prototype.constructor=l}function a(l,t,r){if(a.isBN(l))return l;this.negative=0,this.words=null,this.length=0,this.red=null,l!==null&&((t==="le"||t==="be")&&(r=t,t=10),this._init(l||0,t||10,r||"be"))}typeof x=="object"?x.exports=a:D.BN=a,a.BN=a,a.wordSize=26;var y;try{typeof window<"u"&&typeof window.Buffer<"u"?y=window.Buffer:y=$e.Buffer}catch{}a.isBN=function(t){return t instanceof a?!0:t!==null&&typeof t=="object"&&t.constructor.wordSize===a.wordSize&&Array.isArray(t.words)},a.max=function(t,r){return t.cmp(r)>0?t:r},a.min=function(t,r){return t.cmp(r)<0?t:r},a.prototype._init=function(t,r,i){if(typeof t=="number")return this._initNumber(t,r,i);if(typeof t=="object")return this._initArray(t,r,i);r==="hex"&&(r=16),m(r===(r|0)&&r>=2&&r<=36),t=t.toString().replace(/\s+/g,"");var o=0;t[0]==="-"&&(o++,this.negative=1),o<t.length&&(r===16?this._parseHex(t,o,i):(this._parseBase(t,r,o),i==="le"&&this._initArray(this.toArray(),r,i)))},a.prototype._initNumber=function(t,r,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[t&67108863],this.length=1):t<4503599627370496?(this.words=[t&67108863,t/67108864&67108863],this.length=2):(m(t<9007199254740992),this.words=[t&67108863,t/67108864&67108863,1],this.length=3),i==="le"&&this._initArray(this.toArray(),r,i)},a.prototype._initArray=function(t,r,i){if(m(typeof t.length=="number"),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var f,c,p=0;if(i==="be")for(o=t.length-1,f=0;o>=0;o-=3)c=t[o]|t[o-1]<<8|t[o-2]<<16,this.words[f]|=c<<p&67108863,this.words[f+1]=c>>>26-p&67108863,p+=24,p>=26&&(p-=26,f++);else if(i==="le")for(o=0,f=0;o<t.length;o+=3)c=t[o]|t[o+1]<<8|t[o+2]<<16,this.words[f]|=c<<p&67108863,this.words[f+1]=c>>>26-p&67108863,p+=24,p>=26&&(p-=26,f++);return this.strip()};function w(l,t){var r=l.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function T(l,t,r){var i=w(l,r);return r-1>=t&&(i|=w(l,r-1)<<4),i}a.prototype._parseHex=function(t,r,i){this.length=Math.ceil((t.length-r)/6),this.words=new Array(this.length);for(var o=0;o<this.length;o++)this.words[o]=0;var f=0,c=0,p;if(i==="be")for(o=t.length-1;o>=r;o-=2)p=T(t,r,o)<<f,this.words[c]|=p&67108863,f>=18?(f-=18,c+=1,this.words[c]|=p>>>26):f+=8;else{var s=t.length-r;for(o=s%2===0?r+1:r;o<t.length;o+=2)p=T(t,r,o)<<f,this.words[c]|=p&67108863,f>=18?(f-=18,c+=1,this.words[c]|=p>>>26):f+=8}this.strip()};function g(l,t,r,i){for(var o=0,f=Math.min(l.length,r),c=t;c<f;c++){var p=l.charCodeAt(c)-48;o*=i,p>=49?o+=p-49+10:p>=17?o+=p-17+10:o+=p}return o}a.prototype._parseBase=function(t,r,i){this.words=[0],this.length=1;for(var o=0,f=1;f<=67108863;f*=r)o++;o--,f=f/r|0;for(var c=t.length-i,p=c%o,s=Math.min(c,c-p)+i,e=0,h=i;h<s;h+=o)e=g(t,h,h+o,r),this.imuln(f),this.words[0]+e<67108864?this.words[0]+=e:this._iaddn(e);if(p!==0){var S=1;for(e=g(t,h,t.length,r),h=0;h<p;h++)S*=r;this.imuln(S),this.words[0]+e<67108864?this.words[0]+=e:this._iaddn(e)}this.strip()},a.prototype.copy=function(t){t.words=new Array(this.length);for(var r=0;r<this.length;r++)t.words[r]=this.words[r];t.length=this.length,t.negative=this.negative,t.red=this.red},a.prototype.clone=function(){var t=new a(null);return this.copy(t),t},a.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},a.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},a.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var n=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(t,r){t=t||10,r=r|0||1;var i;if(t===16||t==="hex"){i="";for(var o=0,f=0,c=0;c<this.length;c++){var p=this.words[c],s=((p<<o|f)&16777215).toString(16);f=p>>>24-o&16777215,o+=2,o>=26&&(o-=26,c--),f!==0||c!==this.length-1?i=n[6-s.length]+s+i:i=s+i}for(f!==0&&(i=f.toString(16)+i);i.length%r!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}if(t===(t|0)&&t>=2&&t<=36){var e=u[t],h=v[t];i="";var S=this.clone();for(S.negative=0;!S.isZero();){var B=S.modn(h).toString(t);S=S.idivn(h),S.isZero()?i=B+i:i=n[e-B.length]+B+i}for(this.isZero()&&(i="0"+i);i.length%r!==0;)i="0"+i;return this.negative!==0&&(i="-"+i),i}m(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var t=this.words[0];return this.length===2?t+=this.words[1]*67108864:this.length===3&&this.words[2]===1?t+=4503599627370496+this.words[1]*67108864:this.length>2&&m(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-t:t},a.prototype.toJSON=function(){return this.toString(16)},a.prototype.toBuffer=function(t,r){return m(typeof y<"u"),this.toArrayLike(y,t,r)},a.prototype.toArray=function(t,r){return this.toArrayLike(Array,t,r)},a.prototype.toArrayLike=function(t,r,i){var o=this.byteLength(),f=i||Math.max(1,o);m(o<=f,"byte array longer than desired length"),m(f>0,"Requested array length <= 0"),this.strip();var c=r==="le",p=new t(f),s,e,h=this.clone();if(c){for(e=0;!h.isZero();e++)s=h.andln(255),h.iushrn(8),p[e]=s;for(;e<f;e++)p[e]=0}else{for(e=0;e<f-o;e++)p[e]=0;for(e=0;!h.isZero();e++)s=h.andln(255),h.iushrn(8),p[f-e-1]=s}return p},Math.clz32?a.prototype._countBits=function(t){return 32-Math.clz32(t)}:a.prototype._countBits=function(t){var r=t,i=0;return r>=4096&&(i+=13,r>>>=13),r>=64&&(i+=7,r>>>=7),r>=8&&(i+=4,r>>>=4),r>=2&&(i+=2,r>>>=2),i+r},a.prototype._zeroBits=function(t){if(t===0)return 26;var r=t,i=0;return(r&8191)===0&&(i+=13,r>>>=13),(r&127)===0&&(i+=7,r>>>=7),(r&15)===0&&(i+=4,r>>>=4),(r&3)===0&&(i+=2,r>>>=2),(r&1)===0&&i++,i},a.prototype.bitLength=function(){var t=this.words[this.length-1],r=this._countBits(t);return(this.length-1)*26+r};function d(l){for(var t=new Array(l.bitLength()),r=0;r<t.length;r++){var i=r/26|0,o=r%26;t[r]=(l.words[i]&1<<o)>>>o}return t}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,r=0;r<this.length;r++){var i=this._zeroBits(this.words[r]);if(t+=i,i!==26)break}return t},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(t){return this.negative!==0?this.abs().inotn(t).iaddn(1):this.clone()},a.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]|t.words[r];return this.strip()},a.prototype.ior=function(t){return m((this.negative|t.negative)===0),this.iuor(t)},a.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},a.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},a.prototype.iuand=function(t){var r;this.length>t.length?r=t:r=this;for(var i=0;i<r.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=r.length,this.strip()},a.prototype.iand=function(t){return m((this.negative|t.negative)===0),this.iuand(t)},a.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},a.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},a.prototype.iuxor=function(t){var r,i;this.length>t.length?(r=this,i=t):(r=t,i=this);for(var o=0;o<i.length;o++)this.words[o]=r.words[o]^i.words[o];if(this!==r)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=r.length,this.strip()},a.prototype.ixor=function(t){return m((this.negative|t.negative)===0),this.iuxor(t)},a.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},a.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},a.prototype.inotn=function(t){m(typeof t=="number"&&t>=0);var r=Math.ceil(t/26)|0,i=t%26;this._expand(r),i>0&&r--;for(var o=0;o<r;o++)this.words[o]=~this.words[o]&67108863;return i>0&&(this.words[o]=~this.words[o]&67108863>>26-i),this.strip()},a.prototype.notn=function(t){return this.clone().inotn(t)},a.prototype.setn=function(t,r){m(typeof t=="number"&&t>=0);var i=t/26|0,o=t%26;return this._expand(i+1),r?this.words[i]=this.words[i]|1<<o:this.words[i]=this.words[i]&~(1<<o),this.strip()},a.prototype.iadd=function(t){var r;if(this.negative!==0&&t.negative===0)return this.negative=0,r=this.isub(t),this.negative^=1,this._normSign();if(this.negative===0&&t.negative!==0)return t.negative=0,r=this.isub(t),t.negative=1,r._normSign();var i,o;this.length>t.length?(i=this,o=t):(i=t,o=this);for(var f=0,c=0;c<o.length;c++)r=(i.words[c]|0)+(o.words[c]|0)+f,this.words[c]=r&67108863,f=r>>>26;for(;f!==0&&c<i.length;c++)r=(i.words[c]|0)+f,this.words[c]=r&67108863,f=r>>>26;if(this.length=i.length,f!==0)this.words[this.length]=f,this.length++;else if(i!==this)for(;c<i.length;c++)this.words[c]=i.words[c];return this},a.prototype.add=function(t){var r;return t.negative!==0&&this.negative===0?(t.negative=0,r=this.sub(t),t.negative^=1,r):t.negative===0&&this.negative!==0?(this.negative=0,r=t.sub(this),this.negative=1,r):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},a.prototype.isub=function(t){if(t.negative!==0){t.negative=0;var r=this.iadd(t);return t.negative=1,r._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i=this.cmp(t);if(i===0)return this.negative=0,this.length=1,this.words[0]=0,this;var o,f;i>0?(o=this,f=t):(o=t,f=this);for(var c=0,p=0;p<f.length;p++)r=(o.words[p]|0)-(f.words[p]|0)+c,c=r>>26,this.words[p]=r&67108863;for(;c!==0&&p<o.length;p++)r=(o.words[p]|0)+c,c=r>>26,this.words[p]=r&67108863;if(c===0&&p<o.length&&o!==this)for(;p<o.length;p++)this.words[p]=o.words[p];return this.length=Math.max(this.length,p),o!==this&&(this.negative=1),this.strip()},a.prototype.sub=function(t){return this.clone().isub(t)};function M(l,t,r){r.negative=t.negative^l.negative;var i=l.length+t.length|0;r.length=i,i=i-1|0;var o=l.words[0]|0,f=t.words[0]|0,c=o*f,p=c&67108863,s=c/67108864|0;r.words[0]=p;for(var e=1;e<i;e++){for(var h=s>>>26,S=s&67108863,B=Math.min(e,t.length-1),E=Math.max(0,e-l.length+1);E<=B;E++){var q=e-E|0;o=l.words[q]|0,f=t.words[E]|0,c=o*f+S,h+=c/67108864|0,S=c&67108863}r.words[e]=S|0,s=h|0}return s!==0?r.words[e]=s|0:r.length--,r.strip()}var _=function(t,r,i){var o=t.words,f=r.words,c=i.words,p=0,s,e,h,S=o[0]|0,B=S&8191,E=S>>>13,q=o[1]|0,N=q&8191,j=q>>>13,xt=o[2]|0,I=xt&8191,U=xt>>>13,le=o[3]|0,L=le&8191,P=le>>>13,de=o[4]|0,z=de&8191,K=de>>>13,ce=o[5]|0,$=ce&8191,F=ce>>>13,ve=o[6]|0,G=ve&8191,H=ve>>>13,pe=o[7]|0,J=pe&8191,V=pe>>>13,me=o[8]|0,Y=me&8191,W=me>>>13,ge=o[9]|0,Q=ge&8191,X=ge>>>13,ye=f[0]|0,tt=ye&8191,et=ye>>>13,Me=f[1]|0,rt=Me&8191,it=Me>>>13,we=f[2]|0,nt=we&8191,ot=we>>>13,_e=f[3]|0,st=_e&8191,ht=_e>>>13,xe=f[4]|0,ft=xe&8191,at=xe>>>13,be=f[5]|0,ut=be&8191,lt=be>>>13,Se=f[6]|0,dt=Se&8191,ct=Se>>>13,Be=f[7]|0,vt=Be&8191,pt=Be>>>13,Ee=f[8]|0,mt=Ee&8191,gt=Ee>>>13,ke=f[9]|0,yt=ke&8191,Mt=ke>>>13;i.negative=t.negative^r.negative,i.length=19,s=Math.imul(B,tt),e=Math.imul(B,et),e=e+Math.imul(E,tt)|0,h=Math.imul(E,et);var Rt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,s=Math.imul(N,tt),e=Math.imul(N,et),e=e+Math.imul(j,tt)|0,h=Math.imul(j,et),s=s+Math.imul(B,rt)|0,e=e+Math.imul(B,it)|0,e=e+Math.imul(E,rt)|0,h=h+Math.imul(E,it)|0;var Tt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,s=Math.imul(I,tt),e=Math.imul(I,et),e=e+Math.imul(U,tt)|0,h=Math.imul(U,et),s=s+Math.imul(N,rt)|0,e=e+Math.imul(N,it)|0,e=e+Math.imul(j,rt)|0,h=h+Math.imul(j,it)|0,s=s+Math.imul(B,nt)|0,e=e+Math.imul(B,ot)|0,e=e+Math.imul(E,nt)|0,h=h+Math.imul(E,ot)|0;var Nt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,s=Math.imul(L,tt),e=Math.imul(L,et),e=e+Math.imul(P,tt)|0,h=Math.imul(P,et),s=s+Math.imul(I,rt)|0,e=e+Math.imul(I,it)|0,e=e+Math.imul(U,rt)|0,h=h+Math.imul(U,it)|0,s=s+Math.imul(N,nt)|0,e=e+Math.imul(N,ot)|0,e=e+Math.imul(j,nt)|0,h=h+Math.imul(j,ot)|0,s=s+Math.imul(B,st)|0,e=e+Math.imul(B,ht)|0,e=e+Math.imul(E,st)|0,h=h+Math.imul(E,ht)|0;var Ot=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,s=Math.imul(z,tt),e=Math.imul(z,et),e=e+Math.imul(K,tt)|0,h=Math.imul(K,et),s=s+Math.imul(L,rt)|0,e=e+Math.imul(L,it)|0,e=e+Math.imul(P,rt)|0,h=h+Math.imul(P,it)|0,s=s+Math.imul(I,nt)|0,e=e+Math.imul(I,ot)|0,e=e+Math.imul(U,nt)|0,h=h+Math.imul(U,ot)|0,s=s+Math.imul(N,st)|0,e=e+Math.imul(N,ht)|0,e=e+Math.imul(j,st)|0,h=h+Math.imul(j,ht)|0,s=s+Math.imul(B,ft)|0,e=e+Math.imul(B,at)|0,e=e+Math.imul(E,ft)|0,h=h+Math.imul(E,at)|0;var jt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(jt>>>26)|0,jt&=67108863,s=Math.imul($,tt),e=Math.imul($,et),e=e+Math.imul(F,tt)|0,h=Math.imul(F,et),s=s+Math.imul(z,rt)|0,e=e+Math.imul(z,it)|0,e=e+Math.imul(K,rt)|0,h=h+Math.imul(K,it)|0,s=s+Math.imul(L,nt)|0,e=e+Math.imul(L,ot)|0,e=e+Math.imul(P,nt)|0,h=h+Math.imul(P,ot)|0,s=s+Math.imul(I,st)|0,e=e+Math.imul(I,ht)|0,e=e+Math.imul(U,st)|0,h=h+Math.imul(U,ht)|0,s=s+Math.imul(N,ft)|0,e=e+Math.imul(N,at)|0,e=e+Math.imul(j,ft)|0,h=h+Math.imul(j,at)|0,s=s+Math.imul(B,ut)|0,e=e+Math.imul(B,lt)|0,e=e+Math.imul(E,ut)|0,h=h+Math.imul(E,lt)|0;var It=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(It>>>26)|0,It&=67108863,s=Math.imul(G,tt),e=Math.imul(G,et),e=e+Math.imul(H,tt)|0,h=Math.imul(H,et),s=s+Math.imul($,rt)|0,e=e+Math.imul($,it)|0,e=e+Math.imul(F,rt)|0,h=h+Math.imul(F,it)|0,s=s+Math.imul(z,nt)|0,e=e+Math.imul(z,ot)|0,e=e+Math.imul(K,nt)|0,h=h+Math.imul(K,ot)|0,s=s+Math.imul(L,st)|0,e=e+Math.imul(L,ht)|0,e=e+Math.imul(P,st)|0,h=h+Math.imul(P,ht)|0,s=s+Math.imul(I,ft)|0,e=e+Math.imul(I,at)|0,e=e+Math.imul(U,ft)|0,h=h+Math.imul(U,at)|0,s=s+Math.imul(N,ut)|0,e=e+Math.imul(N,lt)|0,e=e+Math.imul(j,ut)|0,h=h+Math.imul(j,lt)|0,s=s+Math.imul(B,dt)|0,e=e+Math.imul(B,ct)|0,e=e+Math.imul(E,dt)|0,h=h+Math.imul(E,ct)|0;var Ct=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,s=Math.imul(J,tt),e=Math.imul(J,et),e=e+Math.imul(V,tt)|0,h=Math.imul(V,et),s=s+Math.imul(G,rt)|0,e=e+Math.imul(G,it)|0,e=e+Math.imul(H,rt)|0,h=h+Math.imul(H,it)|0,s=s+Math.imul($,nt)|0,e=e+Math.imul($,ot)|0,e=e+Math.imul(F,nt)|0,h=h+Math.imul(F,ot)|0,s=s+Math.imul(z,st)|0,e=e+Math.imul(z,ht)|0,e=e+Math.imul(K,st)|0,h=h+Math.imul(K,ht)|0,s=s+Math.imul(L,ft)|0,e=e+Math.imul(L,at)|0,e=e+Math.imul(P,ft)|0,h=h+Math.imul(P,at)|0,s=s+Math.imul(I,ut)|0,e=e+Math.imul(I,lt)|0,e=e+Math.imul(U,ut)|0,h=h+Math.imul(U,lt)|0,s=s+Math.imul(N,dt)|0,e=e+Math.imul(N,ct)|0,e=e+Math.imul(j,dt)|0,h=h+Math.imul(j,ct)|0,s=s+Math.imul(B,vt)|0,e=e+Math.imul(B,pt)|0,e=e+Math.imul(E,vt)|0,h=h+Math.imul(E,pt)|0;var Ut=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,s=Math.imul(Y,tt),e=Math.imul(Y,et),e=e+Math.imul(W,tt)|0,h=Math.imul(W,et),s=s+Math.imul(J,rt)|0,e=e+Math.imul(J,it)|0,e=e+Math.imul(V,rt)|0,h=h+Math.imul(V,it)|0,s=s+Math.imul(G,nt)|0,e=e+Math.imul(G,ot)|0,e=e+Math.imul(H,nt)|0,h=h+Math.imul(H,ot)|0,s=s+Math.imul($,st)|0,e=e+Math.imul($,ht)|0,e=e+Math.imul(F,st)|0,h=h+Math.imul(F,ht)|0,s=s+Math.imul(z,ft)|0,e=e+Math.imul(z,at)|0,e=e+Math.imul(K,ft)|0,h=h+Math.imul(K,at)|0,s=s+Math.imul(L,ut)|0,e=e+Math.imul(L,lt)|0,e=e+Math.imul(P,ut)|0,h=h+Math.imul(P,lt)|0,s=s+Math.imul(I,dt)|0,e=e+Math.imul(I,ct)|0,e=e+Math.imul(U,dt)|0,h=h+Math.imul(U,ct)|0,s=s+Math.imul(N,vt)|0,e=e+Math.imul(N,pt)|0,e=e+Math.imul(j,vt)|0,h=h+Math.imul(j,pt)|0,s=s+Math.imul(B,mt)|0,e=e+Math.imul(B,gt)|0,e=e+Math.imul(E,mt)|0,h=h+Math.imul(E,gt)|0;var Zt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,s=Math.imul(Q,tt),e=Math.imul(Q,et),e=e+Math.imul(X,tt)|0,h=Math.imul(X,et),s=s+Math.imul(Y,rt)|0,e=e+Math.imul(Y,it)|0,e=e+Math.imul(W,rt)|0,h=h+Math.imul(W,it)|0,s=s+Math.imul(J,nt)|0,e=e+Math.imul(J,ot)|0,e=e+Math.imul(V,nt)|0,h=h+Math.imul(V,ot)|0,s=s+Math.imul(G,st)|0,e=e+Math.imul(G,ht)|0,e=e+Math.imul(H,st)|0,h=h+Math.imul(H,ht)|0,s=s+Math.imul($,ft)|0,e=e+Math.imul($,at)|0,e=e+Math.imul(F,ft)|0,h=h+Math.imul(F,at)|0,s=s+Math.imul(z,ut)|0,e=e+Math.imul(z,lt)|0,e=e+Math.imul(K,ut)|0,h=h+Math.imul(K,lt)|0,s=s+Math.imul(L,dt)|0,e=e+Math.imul(L,ct)|0,e=e+Math.imul(P,dt)|0,h=h+Math.imul(P,ct)|0,s=s+Math.imul(I,vt)|0,e=e+Math.imul(I,pt)|0,e=e+Math.imul(U,vt)|0,h=h+Math.imul(U,pt)|0,s=s+Math.imul(N,mt)|0,e=e+Math.imul(N,gt)|0,e=e+Math.imul(j,mt)|0,h=h+Math.imul(j,gt)|0,s=s+Math.imul(B,yt)|0,e=e+Math.imul(B,Mt)|0,e=e+Math.imul(E,yt)|0,h=h+Math.imul(E,Mt)|0;var Lt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,s=Math.imul(Q,rt),e=Math.imul(Q,it),e=e+Math.imul(X,rt)|0,h=Math.imul(X,it),s=s+Math.imul(Y,nt)|0,e=e+Math.imul(Y,ot)|0,e=e+Math.imul(W,nt)|0,h=h+Math.imul(W,ot)|0,s=s+Math.imul(J,st)|0,e=e+Math.imul(J,ht)|0,e=e+Math.imul(V,st)|0,h=h+Math.imul(V,ht)|0,s=s+Math.imul(G,ft)|0,e=e+Math.imul(G,at)|0,e=e+Math.imul(H,ft)|0,h=h+Math.imul(H,at)|0,s=s+Math.imul($,ut)|0,e=e+Math.imul($,lt)|0,e=e+Math.imul(F,ut)|0,h=h+Math.imul(F,lt)|0,s=s+Math.imul(z,dt)|0,e=e+Math.imul(z,ct)|0,e=e+Math.imul(K,dt)|0,h=h+Math.imul(K,ct)|0,s=s+Math.imul(L,vt)|0,e=e+Math.imul(L,pt)|0,e=e+Math.imul(P,vt)|0,h=h+Math.imul(P,pt)|0,s=s+Math.imul(I,mt)|0,e=e+Math.imul(I,gt)|0,e=e+Math.imul(U,mt)|0,h=h+Math.imul(U,gt)|0,s=s+Math.imul(N,yt)|0,e=e+Math.imul(N,Mt)|0,e=e+Math.imul(j,yt)|0,h=h+Math.imul(j,Mt)|0;var Pt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,s=Math.imul(Q,nt),e=Math.imul(Q,ot),e=e+Math.imul(X,nt)|0,h=Math.imul(X,ot),s=s+Math.imul(Y,st)|0,e=e+Math.imul(Y,ht)|0,e=e+Math.imul(W,st)|0,h=h+Math.imul(W,ht)|0,s=s+Math.imul(J,ft)|0,e=e+Math.imul(J,at)|0,e=e+Math.imul(V,ft)|0,h=h+Math.imul(V,at)|0,s=s+Math.imul(G,ut)|0,e=e+Math.imul(G,lt)|0,e=e+Math.imul(H,ut)|0,h=h+Math.imul(H,lt)|0,s=s+Math.imul($,dt)|0,e=e+Math.imul($,ct)|0,e=e+Math.imul(F,dt)|0,h=h+Math.imul(F,ct)|0,s=s+Math.imul(z,vt)|0,e=e+Math.imul(z,pt)|0,e=e+Math.imul(K,vt)|0,h=h+Math.imul(K,pt)|0,s=s+Math.imul(L,mt)|0,e=e+Math.imul(L,gt)|0,e=e+Math.imul(P,mt)|0,h=h+Math.imul(P,gt)|0,s=s+Math.imul(I,yt)|0,e=e+Math.imul(I,Mt)|0,e=e+Math.imul(U,yt)|0,h=h+Math.imul(U,Mt)|0;var zt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(zt>>>26)|0,zt&=67108863,s=Math.imul(Q,st),e=Math.imul(Q,ht),e=e+Math.imul(X,st)|0,h=Math.imul(X,ht),s=s+Math.imul(Y,ft)|0,e=e+Math.imul(Y,at)|0,e=e+Math.imul(W,ft)|0,h=h+Math.imul(W,at)|0,s=s+Math.imul(J,ut)|0,e=e+Math.imul(J,lt)|0,e=e+Math.imul(V,ut)|0,h=h+Math.imul(V,lt)|0,s=s+Math.imul(G,dt)|0,e=e+Math.imul(G,ct)|0,e=e+Math.imul(H,dt)|0,h=h+Math.imul(H,ct)|0,s=s+Math.imul($,vt)|0,e=e+Math.imul($,pt)|0,e=e+Math.imul(F,vt)|0,h=h+Math.imul(F,pt)|0,s=s+Math.imul(z,mt)|0,e=e+Math.imul(z,gt)|0,e=e+Math.imul(K,mt)|0,h=h+Math.imul(K,gt)|0,s=s+Math.imul(L,yt)|0,e=e+Math.imul(L,Mt)|0,e=e+Math.imul(P,yt)|0,h=h+Math.imul(P,Mt)|0;var Kt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,s=Math.imul(Q,ft),e=Math.imul(Q,at),e=e+Math.imul(X,ft)|0,h=Math.imul(X,at),s=s+Math.imul(Y,ut)|0,e=e+Math.imul(Y,lt)|0,e=e+Math.imul(W,ut)|0,h=h+Math.imul(W,lt)|0,s=s+Math.imul(J,dt)|0,e=e+Math.imul(J,ct)|0,e=e+Math.imul(V,dt)|0,h=h+Math.imul(V,ct)|0,s=s+Math.imul(G,vt)|0,e=e+Math.imul(G,pt)|0,e=e+Math.imul(H,vt)|0,h=h+Math.imul(H,pt)|0,s=s+Math.imul($,mt)|0,e=e+Math.imul($,gt)|0,e=e+Math.imul(F,mt)|0,h=h+Math.imul(F,gt)|0,s=s+Math.imul(z,yt)|0,e=e+Math.imul(z,Mt)|0,e=e+Math.imul(K,yt)|0,h=h+Math.imul(K,Mt)|0;var $t=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+($t>>>26)|0,$t&=67108863,s=Math.imul(Q,ut),e=Math.imul(Q,lt),e=e+Math.imul(X,ut)|0,h=Math.imul(X,lt),s=s+Math.imul(Y,dt)|0,e=e+Math.imul(Y,ct)|0,e=e+Math.imul(W,dt)|0,h=h+Math.imul(W,ct)|0,s=s+Math.imul(J,vt)|0,e=e+Math.imul(J,pt)|0,e=e+Math.imul(V,vt)|0,h=h+Math.imul(V,pt)|0,s=s+Math.imul(G,mt)|0,e=e+Math.imul(G,gt)|0,e=e+Math.imul(H,mt)|0,h=h+Math.imul(H,gt)|0,s=s+Math.imul($,yt)|0,e=e+Math.imul($,Mt)|0,e=e+Math.imul(F,yt)|0,h=h+Math.imul(F,Mt)|0;var Ft=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,s=Math.imul(Q,dt),e=Math.imul(Q,ct),e=e+Math.imul(X,dt)|0,h=Math.imul(X,ct),s=s+Math.imul(Y,vt)|0,e=e+Math.imul(Y,pt)|0,e=e+Math.imul(W,vt)|0,h=h+Math.imul(W,pt)|0,s=s+Math.imul(J,mt)|0,e=e+Math.imul(J,gt)|0,e=e+Math.imul(V,mt)|0,h=h+Math.imul(V,gt)|0,s=s+Math.imul(G,yt)|0,e=e+Math.imul(G,Mt)|0,e=e+Math.imul(H,yt)|0,h=h+Math.imul(H,Mt)|0;var Gt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Gt>>>26)|0,Gt&=67108863,s=Math.imul(Q,vt),e=Math.imul(Q,pt),e=e+Math.imul(X,vt)|0,h=Math.imul(X,pt),s=s+Math.imul(Y,mt)|0,e=e+Math.imul(Y,gt)|0,e=e+Math.imul(W,mt)|0,h=h+Math.imul(W,gt)|0,s=s+Math.imul(J,yt)|0,e=e+Math.imul(J,Mt)|0,e=e+Math.imul(V,yt)|0,h=h+Math.imul(V,Mt)|0;var Ht=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Ht>>>26)|0,Ht&=67108863,s=Math.imul(Q,mt),e=Math.imul(Q,gt),e=e+Math.imul(X,mt)|0,h=Math.imul(X,gt),s=s+Math.imul(Y,yt)|0,e=e+Math.imul(Y,Mt)|0,e=e+Math.imul(W,yt)|0,h=h+Math.imul(W,Mt)|0;var Jt=(p+s|0)+((e&8191)<<13)|0;p=(h+(e>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,s=Math.imul(Q,yt),e=Math.imul(Q,Mt),e=e+Math.imul(X,yt)|0,h=Math.imul(X,Mt);var Vt=(p+s|0)+((e&8191)<<13)|0;return p=(h+(e>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,c[0]=Rt,c[1]=Tt,c[2]=Nt,c[3]=Ot,c[4]=jt,c[5]=It,c[6]=Ct,c[7]=Ut,c[8]=Zt,c[9]=Lt,c[10]=Pt,c[11]=zt,c[12]=Kt,c[13]=$t,c[14]=Ft,c[15]=Gt,c[16]=Ht,c[17]=Jt,c[18]=Vt,p!==0&&(c[19]=p,i.length++),i};Math.imul||(_=M);function k(l,t,r){r.negative=t.negative^l.negative,r.length=l.length+t.length;for(var i=0,o=0,f=0;f<r.length-1;f++){var c=o;o=0;for(var p=i&67108863,s=Math.min(f,t.length-1),e=Math.max(0,f-l.length+1);e<=s;e++){var h=f-e,S=l.words[h]|0,B=t.words[e]|0,E=S*B,q=E&67108863;c=c+(E/67108864|0)|0,q=q+p|0,p=q&67108863,c=c+(q>>>26)|0,o+=c>>>26,c&=67108863}r.words[f]=p,i=c,c=o}return i!==0?r.words[f]=i:r.length--,r.strip()}function A(l,t,r){var i=new O;return i.mulp(l,t,r)}a.prototype.mulTo=function(t,r){var i,o=this.length+t.length;return this.length===10&&t.length===10?i=_(this,t,r):o<63?i=M(this,t,r):o<1024?i=k(this,t,r):i=A(this,t,r),i};function O(l,t){this.x=l,this.y=t}O.prototype.makeRBT=function(t){for(var r=new Array(t),i=a.prototype._countBits(t)-1,o=0;o<t;o++)r[o]=this.revBin(o,i,t);return r},O.prototype.revBin=function(t,r,i){if(t===0||t===i-1)return t;for(var o=0,f=0;f<r;f++)o|=(t&1)<<r-f-1,t>>=1;return o},O.prototype.permute=function(t,r,i,o,f,c){for(var p=0;p<c;p++)o[p]=r[t[p]],f[p]=i[t[p]]},O.prototype.transform=function(t,r,i,o,f,c){this.permute(c,t,r,i,o,f);for(var p=1;p<f;p<<=1)for(var s=p<<1,e=Math.cos(2*Math.PI/s),h=Math.sin(2*Math.PI/s),S=0;S<f;S+=s)for(var B=e,E=h,q=0;q<p;q++){var N=i[S+q],j=o[S+q],xt=i[S+q+p],I=o[S+q+p],U=B*xt-E*I;I=B*I+E*xt,xt=U,i[S+q]=N+xt,o[S+q]=j+I,i[S+q+p]=N-xt,o[S+q+p]=j-I,q!==s&&(U=e*B-h*E,E=e*E+h*B,B=U)}},O.prototype.guessLen13b=function(t,r){var i=Math.max(r,t)|1,o=i&1,f=0;for(i=i/2|0;i;i=i>>>1)f++;return 1<<f+1+o},O.prototype.conjugate=function(t,r,i){if(!(i<=1))for(var o=0;o<i/2;o++){var f=t[o];t[o]=t[i-o-1],t[i-o-1]=f,f=r[o],r[o]=-r[i-o-1],r[i-o-1]=-f}},O.prototype.normalize13b=function(t,r){for(var i=0,o=0;o<r/2;o++){var f=Math.round(t[2*o+1]/r)*8192+Math.round(t[2*o]/r)+i;t[o]=f&67108863,f<67108864?i=0:i=f/67108864|0}return t},O.prototype.convert13b=function(t,r,i,o){for(var f=0,c=0;c<r;c++)f=f+(t[c]|0),i[2*c]=f&8191,f=f>>>13,i[2*c+1]=f&8191,f=f>>>13;for(c=2*r;c<o;++c)i[c]=0;m(f===0),m((f&-8192)===0)},O.prototype.stub=function(t){for(var r=new Array(t),i=0;i<t;i++)r[i]=0;return r},O.prototype.mulp=function(t,r,i){var o=2*this.guessLen13b(t.length,r.length),f=this.makeRBT(o),c=this.stub(o),p=new Array(o),s=new Array(o),e=new Array(o),h=new Array(o),S=new Array(o),B=new Array(o),E=i.words;E.length=o,this.convert13b(t.words,t.length,p,o),this.convert13b(r.words,r.length,h,o),this.transform(p,c,s,e,o,f),this.transform(h,c,S,B,o,f);for(var q=0;q<o;q++){var N=s[q]*S[q]-e[q]*B[q];e[q]=s[q]*B[q]+e[q]*S[q],s[q]=N}return this.conjugate(s,e,o),this.transform(s,e,E,c,o,f),this.conjugate(E,c,o),this.normalize13b(E,o),i.negative=t.negative^r.negative,i.length=t.length+r.length,i.strip()},a.prototype.mul=function(t){var r=new a(null);return r.words=new Array(this.length+t.length),this.mulTo(t,r)},a.prototype.mulf=function(t){var r=new a(null);return r.words=new Array(this.length+t.length),A(this,t,r)},a.prototype.imul=function(t){return this.clone().mulTo(t,this)},a.prototype.imuln=function(t){m(typeof t=="number"),m(t<67108864);for(var r=0,i=0;i<this.length;i++){var o=(this.words[i]|0)*t,f=(o&67108863)+(r&67108863);r>>=26,r+=o/67108864|0,r+=f>>>26,this.words[i]=f&67108863}return r!==0&&(this.words[i]=r,this.length++),this},a.prototype.muln=function(t){return this.clone().imuln(t)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(t){var r=d(t);if(r.length===0)return new a(1);for(var i=this,o=0;o<r.length&&r[o]===0;o++,i=i.sqr());if(++o<r.length)for(var f=i.sqr();o<r.length;o++,f=f.sqr())r[o]!==0&&(i=i.mul(f));return i},a.prototype.iushln=function(t){m(typeof t=="number"&&t>=0);var r=t%26,i=(t-r)/26,o=67108863>>>26-r<<26-r,f;if(r!==0){var c=0;for(f=0;f<this.length;f++){var p=this.words[f]&o,s=(this.words[f]|0)-p<<r;this.words[f]=s|c,c=p>>>26-r}c&&(this.words[f]=c,this.length++)}if(i!==0){for(f=this.length-1;f>=0;f--)this.words[f+i]=this.words[f];for(f=0;f<i;f++)this.words[f]=0;this.length+=i}return this.strip()},a.prototype.ishln=function(t){return m(this.negative===0),this.iushln(t)},a.prototype.iushrn=function(t,r,i){m(typeof t=="number"&&t>=0);var o;r?o=(r-r%26)/26:o=0;var f=t%26,c=Math.min((t-f)/26,this.length),p=67108863^67108863>>>f<<f,s=i;if(o-=c,o=Math.max(0,o),s){for(var e=0;e<c;e++)s.words[e]=this.words[e];s.length=c}if(c!==0)if(this.length>c)for(this.length-=c,e=0;e<this.length;e++)this.words[e]=this.words[e+c];else this.words[0]=0,this.length=1;var h=0;for(e=this.length-1;e>=0&&(h!==0||e>=o);e--){var S=this.words[e]|0;this.words[e]=h<<26-f|S>>>f,h=S&p}return s&&h!==0&&(s.words[s.length++]=h),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},a.prototype.ishrn=function(t,r,i){return m(this.negative===0),this.iushrn(t,r,i)},a.prototype.shln=function(t){return this.clone().ishln(t)},a.prototype.ushln=function(t){return this.clone().iushln(t)},a.prototype.shrn=function(t){return this.clone().ishrn(t)},a.prototype.ushrn=function(t){return this.clone().iushrn(t)},a.prototype.testn=function(t){m(typeof t=="number"&&t>=0);var r=t%26,i=(t-r)/26,o=1<<r;if(this.length<=i)return!1;var f=this.words[i];return!!(f&o)},a.prototype.imaskn=function(t){m(typeof t=="number"&&t>=0);var r=t%26,i=(t-r)/26;if(m(this.negative===0,"imaskn works only with positive numbers"),this.length<=i)return this;if(r!==0&&i++,this.length=Math.min(i,this.length),r!==0){var o=67108863^67108863>>>r<<r;this.words[this.length-1]&=o}return this.strip()},a.prototype.maskn=function(t){return this.clone().imaskn(t)},a.prototype.iaddn=function(t){return m(typeof t=="number"),m(t<67108864),t<0?this.isubn(-t):this.negative!==0?this.length===1&&(this.words[0]|0)<t?(this.words[0]=t-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},a.prototype._iaddn=function(t){this.words[0]+=t;for(var r=0;r<this.length&&this.words[r]>=67108864;r++)this.words[r]-=67108864,r===this.length-1?this.words[r+1]=1:this.words[r+1]++;return this.length=Math.max(this.length,r+1),this},a.prototype.isubn=function(t){if(m(typeof t=="number"),m(t<67108864),t<0)return this.iaddn(-t);if(this.negative!==0)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var r=0;r<this.length&&this.words[r]<0;r++)this.words[r]+=67108864,this.words[r+1]-=1;return this.strip()},a.prototype.addn=function(t){return this.clone().iaddn(t)},a.prototype.subn=function(t){return this.clone().isubn(t)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(t,r,i){var o=t.length+i,f;this._expand(o);var c,p=0;for(f=0;f<t.length;f++){c=(this.words[f+i]|0)+p;var s=(t.words[f]|0)*r;c-=s&67108863,p=(c>>26)-(s/67108864|0),this.words[f+i]=c&67108863}for(;f<this.length-i;f++)c=(this.words[f+i]|0)+p,p=c>>26,this.words[f+i]=c&67108863;if(p===0)return this.strip();for(m(p===-1),p=0,f=0;f<this.length;f++)c=-(this.words[f]|0)+p,p=c>>26,this.words[f]=c&67108863;return this.negative=1,this.strip()},a.prototype._wordDiv=function(t,r){var i=this.length-t.length,o=this.clone(),f=t,c=f.words[f.length-1]|0,p=this._countBits(c);i=26-p,i!==0&&(f=f.ushln(i),o.iushln(i),c=f.words[f.length-1]|0);var s=o.length-f.length,e;if(r!=="mod"){e=new a(null),e.length=s+1,e.words=new Array(e.length);for(var h=0;h<e.length;h++)e.words[h]=0}var S=o.clone()._ishlnsubmul(f,1,s);S.negative===0&&(o=S,e&&(e.words[s]=1));for(var B=s-1;B>=0;B--){var E=(o.words[f.length+B]|0)*67108864+(o.words[f.length+B-1]|0);for(E=Math.min(E/c|0,67108863),o._ishlnsubmul(f,E,B);o.negative!==0;)E--,o.negative=0,o._ishlnsubmul(f,1,B),o.isZero()||(o.negative^=1);e&&(e.words[B]=E)}return e&&e.strip(),o.strip(),r!=="div"&&i!==0&&o.iushrn(i),{div:e||null,mod:o}},a.prototype.divmod=function(t,r,i){if(m(!t.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var o,f,c;return this.negative!==0&&t.negative===0?(c=this.neg().divmod(t,r),r!=="mod"&&(o=c.div.neg()),r!=="div"&&(f=c.mod.neg(),i&&f.negative!==0&&f.iadd(t)),{div:o,mod:f}):this.negative===0&&t.negative!==0?(c=this.divmod(t.neg(),r),r!=="mod"&&(o=c.div.neg()),{div:o,mod:c.mod}):(this.negative&t.negative)!==0?(c=this.neg().divmod(t.neg(),r),r!=="div"&&(f=c.mod.neg(),i&&f.negative!==0&&f.isub(t)),{div:c.div,mod:f}):t.length>this.length||this.cmp(t)<0?{div:new a(0),mod:this}:t.length===1?r==="div"?{div:this.divn(t.words[0]),mod:null}:r==="mod"?{div:null,mod:new a(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new a(this.modn(t.words[0]))}:this._wordDiv(t,r)},a.prototype.div=function(t){return this.divmod(t,"div",!1).div},a.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},a.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},a.prototype.divRound=function(t){var r=this.divmod(t);if(r.mod.isZero())return r.div;var i=r.div.negative!==0?r.mod.isub(t):r.mod,o=t.ushrn(1),f=t.andln(1),c=i.cmp(o);return c<0||f===1&&c===0?r.div:r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)},a.prototype.modn=function(t){m(t<=67108863);for(var r=(1<<26)%t,i=0,o=this.length-1;o>=0;o--)i=(r*i+(this.words[o]|0))%t;return i},a.prototype.idivn=function(t){m(t<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(this.words[i]|0)+r*67108864;this.words[i]=o/t|0,r=o%t}return this.strip()},a.prototype.divn=function(t){return this.clone().idivn(t)},a.prototype.egcd=function(t){m(t.negative===0),m(!t.isZero());var r=this,i=t.clone();r.negative!==0?r=r.umod(t):r=r.clone();for(var o=new a(1),f=new a(0),c=new a(0),p=new a(1),s=0;r.isEven()&&i.isEven();)r.iushrn(1),i.iushrn(1),++s;for(var e=i.clone(),h=r.clone();!r.isZero();){for(var S=0,B=1;(r.words[0]&B)===0&&S<26;++S,B<<=1);if(S>0)for(r.iushrn(S);S-- >0;)(o.isOdd()||f.isOdd())&&(o.iadd(e),f.isub(h)),o.iushrn(1),f.iushrn(1);for(var E=0,q=1;(i.words[0]&q)===0&&E<26;++E,q<<=1);if(E>0)for(i.iushrn(E);E-- >0;)(c.isOdd()||p.isOdd())&&(c.iadd(e),p.isub(h)),c.iushrn(1),p.iushrn(1);r.cmp(i)>=0?(r.isub(i),o.isub(c),f.isub(p)):(i.isub(r),c.isub(o),p.isub(f))}return{a:c,b:p,gcd:i.iushln(s)}},a.prototype._invmp=function(t){m(t.negative===0),m(!t.isZero());var r=this,i=t.clone();r.negative!==0?r=r.umod(t):r=r.clone();for(var o=new a(1),f=new a(0),c=i.clone();r.cmpn(1)>0&&i.cmpn(1)>0;){for(var p=0,s=1;(r.words[0]&s)===0&&p<26;++p,s<<=1);if(p>0)for(r.iushrn(p);p-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var e=0,h=1;(i.words[0]&h)===0&&e<26;++e,h<<=1);if(e>0)for(i.iushrn(e);e-- >0;)f.isOdd()&&f.iadd(c),f.iushrn(1);r.cmp(i)>=0?(r.isub(i),o.isub(f)):(i.isub(r),f.isub(o))}var S;return r.cmpn(1)===0?S=o:S=f,S.cmpn(0)<0&&S.iadd(t),S},a.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var r=this.clone(),i=t.clone();r.negative=0,i.negative=0;for(var o=0;r.isEven()&&i.isEven();o++)r.iushrn(1),i.iushrn(1);do{for(;r.isEven();)r.iushrn(1);for(;i.isEven();)i.iushrn(1);var f=r.cmp(i);if(f<0){var c=r;r=i,i=c}else if(f===0||i.cmpn(1)===0)break;r.isub(i)}while(!0);return i.iushln(o)},a.prototype.invm=function(t){return this.egcd(t).a.umod(t)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(t){return this.words[0]&t},a.prototype.bincn=function(t){m(typeof t=="number");var r=t%26,i=(t-r)/26,o=1<<r;if(this.length<=i)return this._expand(i+1),this.words[i]|=o,this;for(var f=o,c=i;f!==0&&c<this.length;c++){var p=this.words[c]|0;p+=f,f=p>>>26,p&=67108863,this.words[c]=p}return f!==0&&(this.words[c]=f,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(t){var r=t<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();var i;if(this.length>1)i=1;else{r&&(t=-t),m(t<=67108863,"Number is too big");var o=this.words[0]|0;i=o===t?0:o<t?-1:1}return this.negative!==0?-i|0:i},a.prototype.cmp=function(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var r=this.ucmp(t);return this.negative!==0?-r|0:r},a.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var r=0,i=this.length-1;i>=0;i--){var o=this.words[i]|0,f=t.words[i]|0;if(o!==f){o<f?r=-1:o>f&&(r=1);break}}return r},a.prototype.gtn=function(t){return this.cmpn(t)===1},a.prototype.gt=function(t){return this.cmp(t)===1},a.prototype.gten=function(t){return this.cmpn(t)>=0},a.prototype.gte=function(t){return this.cmp(t)>=0},a.prototype.ltn=function(t){return this.cmpn(t)===-1},a.prototype.lt=function(t){return this.cmp(t)===-1},a.prototype.lten=function(t){return this.cmpn(t)<=0},a.prototype.lte=function(t){return this.cmp(t)<=0},a.prototype.eqn=function(t){return this.cmpn(t)===0},a.prototype.eq=function(t){return this.cmp(t)===0},a.red=function(t){return new Z(t)},a.prototype.toRed=function(t){return m(!this.red,"Already a number in reduction context"),m(this.negative===0,"red works only with positives"),t.convertTo(this)._forceRed(t)},a.prototype.fromRed=function(){return m(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(t){return this.red=t,this},a.prototype.forceRed=function(t){return m(!this.red,"Already a number in reduction context"),this._forceRed(t)},a.prototype.redAdd=function(t){return m(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},a.prototype.redIAdd=function(t){return m(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},a.prototype.redSub=function(t){return m(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},a.prototype.redISub=function(t){return m(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},a.prototype.redShl=function(t){return m(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},a.prototype.redMul=function(t){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},a.prototype.redIMul=function(t){return m(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},a.prototype.redSqr=function(){return m(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return m(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return m(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return m(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return m(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(t){return m(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var wt={k256:null,p224:null,p192:null,p25519:null};function C(l,t){this.name=l,this.p=new a(t,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var t=new a(null);return t.words=new Array(Math.ceil(this.n/13)),t},C.prototype.ireduce=function(t){var r=t,i;do this.split(r,this.tmp),r=this.imulK(r),r=r.iadd(this.tmp),i=r.bitLength();while(i>this.n);var o=i<this.n?-1:r.ucmp(this.p);return o===0?(r.words[0]=0,r.length=1):o>0?r.isub(this.p):r.strip!==void 0?r.strip():r._strip(),r},C.prototype.split=function(t,r){t.iushrn(this.n,0,r)},C.prototype.imulK=function(t){return t.imul(this.k)};function _t(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}b(_t,C),_t.prototype.split=function(t,r){for(var i=4194303,o=Math.min(t.length,9),f=0;f<o;f++)r.words[f]=t.words[f];if(r.length=o,t.length<=9){t.words[0]=0,t.length=1;return}var c=t.words[9];for(r.words[r.length++]=c&i,f=10;f<t.length;f++){var p=t.words[f]|0;t.words[f-10]=(p&i)<<4|c>>>22,c=p}c>>>=22,t.words[f-10]=c,c===0&&t.length>10?t.length-=10:t.length-=9},_t.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var r=0,i=0;i<t.length;i++){var o=t.words[i]|0;r+=o*977,t.words[i]=r&67108863,r=o*64+(r/67108864|0)}return t.words[t.length-1]===0&&(t.length--,t.words[t.length-1]===0&&t.length--),t};function Bt(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}b(Bt,C);function qt(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}b(qt,C);function Et(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}b(Et,C),Et.prototype.imulK=function(t){for(var r=0,i=0;i<t.length;i++){var o=(t.words[i]|0)*19+r,f=o&67108863;o>>>=26,t.words[i]=f,r=o}return r!==0&&(t.words[t.length++]=r),t},a._prime=function(t){if(wt[t])return wt[t];var r;if(t==="k256")r=new _t;else if(t==="p224")r=new Bt;else if(t==="p192")r=new qt;else if(t==="p25519")r=new Et;else throw new Error("Unknown prime "+t);return wt[t]=r,r};function Z(l){if(typeof l=="string"){var t=a._prime(l);this.m=t.p,this.prime=t}else m(l.gtn(1),"modulus must be greater than 1"),this.m=l,this.prime=null}Z.prototype._verify1=function(t){m(t.negative===0,"red works only with positives"),m(t.red,"red works only with red numbers")},Z.prototype._verify2=function(t,r){m((t.negative|r.negative)===0,"red works only with positives"),m(t.red&&t.red===r.red,"red works only with red numbers")},Z.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},Z.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},Z.prototype.add=function(t,r){this._verify2(t,r);var i=t.add(r);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},Z.prototype.iadd=function(t,r){this._verify2(t,r);var i=t.iadd(r);return i.cmp(this.m)>=0&&i.isub(this.m),i},Z.prototype.sub=function(t,r){this._verify2(t,r);var i=t.sub(r);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},Z.prototype.isub=function(t,r){this._verify2(t,r);var i=t.isub(r);return i.cmpn(0)<0&&i.iadd(this.m),i},Z.prototype.shl=function(t,r){return this._verify1(t),this.imod(t.ushln(r))},Z.prototype.imul=function(t,r){return this._verify2(t,r),this.imod(t.imul(r))},Z.prototype.mul=function(t,r){return this._verify2(t,r),this.imod(t.mul(r))},Z.prototype.isqr=function(t){return this.imul(t,t.clone())},Z.prototype.sqr=function(t){return this.mul(t,t)},Z.prototype.sqrt=function(t){if(t.isZero())return t.clone();var r=this.m.andln(3);if(m(r%2===1),r===3){var i=this.m.add(new a(1)).iushrn(2);return this.pow(t,i)}for(var o=this.m.subn(1),f=0;!o.isZero()&&o.andln(1)===0;)f++,o.iushrn(1);m(!o.isZero());var c=new a(1).toRed(this),p=c.redNeg(),s=this.m.subn(1).iushrn(1),e=this.m.bitLength();for(e=new a(2*e*e).toRed(this);this.pow(e,s).cmp(p)!==0;)e.redIAdd(p);for(var h=this.pow(e,o),S=this.pow(t,o.addn(1).iushrn(1)),B=this.pow(t,o),E=f;B.cmp(c)!==0;){for(var q=B,N=0;q.cmp(c)!==0;N++)q=q.redSqr();m(N<E);var j=this.pow(h,new a(1).iushln(E-N-1));S=S.redMul(j),h=j.redSqr(),B=B.redMul(h),E=N}return S},Z.prototype.invm=function(t){var r=t._invmp(this.m);return r.negative!==0?(r.negative=0,this.imod(r).redNeg()):this.imod(r)},Z.prototype.pow=function(t,r){if(r.isZero())return new a(1).toRed(this);if(r.cmpn(1)===0)return t.clone();var i=4,o=new Array(1<<i);o[0]=new a(1).toRed(this),o[1]=t;for(var f=2;f<o.length;f++)o[f]=this.mul(o[f-1],t);var c=o[0],p=0,s=0,e=r.bitLength()%26;for(e===0&&(e=26),f=r.length-1;f>=0;f--){for(var h=r.words[f],S=e-1;S>=0;S--){var B=h>>S&1;if(c!==o[0]&&(c=this.sqr(c)),B===0&&p===0){s=0;continue}p<<=1,p|=B,s++,!(s!==i&&(f!==0||S!==0))&&(c=this.mul(c,o[p]),s=0,p=0)}e=26}return c},Z.prototype.convertTo=function(t){var r=t.umod(this.m);return r===t?r.clone():r},Z.prototype.convertFrom=function(t){var r=t.clone();return r.red=null,r},a.mont=function(t){return new bt(t)};function bt(l){Z.call(this,l),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b(bt,Z),bt.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},bt.prototype.convertFrom=function(t){var r=this.imod(t.mul(this.rinv));return r.red=null,r},bt.prototype.imul=function(t,r){if(t.isZero()||r.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(r),o=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),f=i.isub(o).iushrn(this.shift),c=f;return f.cmp(this.m)>=0?c=f.isub(this.m):f.cmpn(0)<0&&(c=f.iadd(this.m)),c._forceRed(this)},bt.prototype.mul=function(t,r){if(t.isZero()||r.isZero())return new a(0)._forceRed(this);var i=t.mul(r),o=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),f=i.isub(o).iushrn(this.shift),c=f;return f.cmp(this.m)>=0?c=f.isub(this.m):f.cmpn(0)<0&&(c=f.iadd(this.m)),c._forceRed(this)},bt.prototype.invm=function(t){var r=this.imod(t._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(R,Qe)}(Dt)),Dt.exports}var Wt={},Ae;function tr(){return Ae||(Ae=1,function(R){var x=ue(),D=St(),m=R;m.define=function(y,w){return new b(y,w)};function b(a,y){this.name=a,this.body=y,this.decoders={},this.encoders={}}b.prototype._createNamed=function(y){var w;try{w=$e.runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{w=function(g){this._initNamed(g)}}return D(w,y),w.prototype._initNamed=function(g){y.call(this,g)},new w(this)},b.prototype._getDecoder=function(y){return y=y||"der",this.decoders.hasOwnProperty(y)||(this.decoders[y]=this._createNamed(x.decoders[y])),this.decoders[y]},b.prototype.decode=function(y,w,T){return this._getDecoder(w).decode(y,T)},b.prototype._getEncoder=function(y){return y=y||"der",this.encoders.hasOwnProperty(y)||(this.encoders[y]=this._createNamed(x.encoders[y])),this.encoders[y]},b.prototype.encode=function(y,w,T){return this._getEncoder(w).encode(y,T)}}(Wt)),Wt}var Qt={},Xt={},De;function er(){if(De)return Xt;De=1;var R=St();function x(m){this._reporterState={obj:null,path:[],options:m||{},errors:[]}}Xt.Reporter=x,x.prototype.isError=function(b){return b instanceof D},x.prototype.save=function(){var b=this._reporterState;return{obj:b.obj,pathLen:b.path.length}},x.prototype.restore=function(b){var a=this._reporterState;a.obj=b.obj,a.path=a.path.slice(0,b.pathLen)},x.prototype.enterKey=function(b){return this._reporterState.path.push(b)},x.prototype.exitKey=function(b){var a=this._reporterState;a.path=a.path.slice(0,b-1)},x.prototype.leaveKey=function(b,a,y){var w=this._reporterState;this.exitKey(b),w.obj!==null&&(w.obj[a]=y)},x.prototype.path=function(){return this._reporterState.path.join("/")},x.prototype.enterObject=function(){var b=this._reporterState,a=b.obj;return b.obj={},a},x.prototype.leaveObject=function(b){var a=this._reporterState,y=a.obj;return a.obj=b,y},x.prototype.error=function(b){var a,y=this._reporterState,w=b instanceof D;if(w?a=b:a=new D(y.path.map(function(T){return"["+JSON.stringify(T)+"]"}).join(""),b.message||b,b.stack),!y.options.partial)throw a;return w||y.errors.push(a),a},x.prototype.wrapResult=function(b){var a=this._reporterState;return a.options.partial?{result:this.isError(b)?null:b,errors:a.errors}:b};function D(m,b){this.path=m,this.rethrow(b)}return R(D,Error),D.prototype.rethrow=function(b){if(this.message=b+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,D),!this.stack)try{throw new Error(this.message)}catch(a){this.stack=a.stack}return this},Xt}var At={},Re;function Te(){if(Re)return At;Re=1;var R=St(),x=kt().Reporter,D=ae().Buffer;function m(a,y){if(x.call(this,y),!D.isBuffer(a)){this.error("Input not Buffer");return}this.base=a,this.offset=0,this.length=a.length}R(m,x),At.DecoderBuffer=m,m.prototype.save=function(){return{offset:this.offset,reporter:x.prototype.save.call(this)}},m.prototype.restore=function(y){var w=new m(this.base);return w.offset=y.offset,w.length=this.offset,this.offset=y.offset,x.prototype.restore.call(this,y.reporter),w},m.prototype.isEmpty=function(){return this.offset===this.length},m.prototype.readUInt8=function(y){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(y||"DecoderBuffer overrun")},m.prototype.skip=function(y,w){if(!(this.offset+y<=this.length))return this.error(w||"DecoderBuffer overrun");var T=new m(this.base);return T._reporterState=this._reporterState,T.offset=this.offset,T.length=this.offset+y,this.offset+=y,T},m.prototype.raw=function(y){return this.base.slice(y?y.offset:this.offset,this.length)};function b(a,y){if(Array.isArray(a))this.length=0,this.value=a.map(function(w){return w instanceof b||(w=new b(w,y)),this.length+=w.length,w},this);else if(typeof a=="number"){if(!(0<=a&&a<=255))return y.error("non-byte EncoderBuffer value");this.value=a,this.length=1}else if(typeof a=="string")this.value=a,this.length=D.byteLength(a);else if(D.isBuffer(a))this.value=a,this.length=a.length;else return y.error("Unsupported type: "+typeof a)}return At.EncoderBuffer=b,b.prototype.join=function(y,w){return y||(y=new D(this.length)),w||(w=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(T){T.join(y,w),w+=T.length}):(typeof this.value=="number"?y[w]=this.value:typeof this.value=="string"?y.write(this.value,w):D.isBuffer(this.value)&&this.value.copy(y,w),w+=this.length)),y},At}var te,Ne;function rr(){if(Ne)return te;Ne=1;var R=kt().Reporter,x=kt().EncoderBuffer,D=kt().DecoderBuffer,m=Ve(),b=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],a=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(b),y=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function w(g,n){var u={};this._baseState=u,u.enc=g,u.parent=n||null,u.children=null,u.tag=null,u.args=null,u.reverseArgs=null,u.choice=null,u.optional=!1,u.any=!1,u.obj=!1,u.use=null,u.useDecoder=null,u.key=null,u.default=null,u.explicit=null,u.implicit=null,u.contains=null,u.parent||(u.children=[],this._wrap())}te=w;var T=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return w.prototype.clone=function(){var n=this._baseState,u={};T.forEach(function(d){u[d]=n[d]});var v=new this.constructor(u.parent);return v._baseState=u,v},w.prototype._wrap=function(){var n=this._baseState;a.forEach(function(u){this[u]=function(){var d=new this.constructor(this);return n.children.push(d),d[u].apply(d,arguments)}},this)},w.prototype._init=function(n){var u=this._baseState;m(u.parent===null),n.call(this),u.children=u.children.filter(function(v){return v._baseState.parent===this},this),m.equal(u.children.length,1,"Root node can have only one child")},w.prototype._useArgs=function(n){var u=this._baseState,v=n.filter(function(d){return d instanceof this.constructor},this);n=n.filter(function(d){return!(d instanceof this.constructor)},this),v.length!==0&&(m(u.children===null),u.children=v,v.forEach(function(d){d._baseState.parent=this},this)),n.length!==0&&(m(u.args===null),u.args=n,u.reverseArgs=n.map(function(d){if(typeof d!="object"||d.constructor!==Object)return d;var M={};return Object.keys(d).forEach(function(_){_==(_|0)&&(_|=0);var k=d[_];M[k]=_}),M}))},y.forEach(function(g){w.prototype[g]=function(){var u=this._baseState;throw new Error(g+" not implemented for encoding: "+u.enc)}}),b.forEach(function(g){w.prototype[g]=function(){var u=this._baseState,v=Array.prototype.slice.call(arguments);return m(u.tag===null),u.tag=g,this._useArgs(v),this}}),w.prototype.use=function(n){m(n);var u=this._baseState;return m(u.use===null),u.use=n,this},w.prototype.optional=function(){var n=this._baseState;return n.optional=!0,this},w.prototype.def=function(n){var u=this._baseState;return m(u.default===null),u.default=n,u.optional=!0,this},w.prototype.explicit=function(n){var u=this._baseState;return m(u.explicit===null&&u.implicit===null),u.explicit=n,this},w.prototype.implicit=function(n){var u=this._baseState;return m(u.explicit===null&&u.implicit===null),u.implicit=n,this},w.prototype.obj=function(){var n=this._baseState,u=Array.prototype.slice.call(arguments);return n.obj=!0,u.length!==0&&this._useArgs(u),this},w.prototype.key=function(n){var u=this._baseState;return m(u.key===null),u.key=n,this},w.prototype.any=function(){var n=this._baseState;return n.any=!0,this},w.prototype.choice=function(n){var u=this._baseState;return m(u.choice===null),u.choice=n,this._useArgs(Object.keys(n).map(function(v){return n[v]})),this},w.prototype.contains=function(n){var u=this._baseState;return m(u.use===null),u.contains=n,this},w.prototype._decode=function(n,u){var v=this._baseState;if(v.parent===null)return n.wrapResult(v.children[0]._decode(n,u));var d=v.default,M=!0,_=null;if(v.key!==null&&(_=n.enterKey(v.key)),v.optional){var k=null;if(v.explicit!==null?k=v.explicit:v.implicit!==null?k=v.implicit:v.tag!==null&&(k=v.tag),k===null&&!v.any){var A=n.save();try{v.choice===null?this._decodeGeneric(v.tag,n,u):this._decodeChoice(n,u),M=!0}catch{M=!1}n.restore(A)}else if(M=this._peekTag(n,k,v.any),n.isError(M))return M}var O;if(v.obj&&M&&(O=n.enterObject()),M){if(v.explicit!==null){var wt=this._decodeTag(n,v.explicit);if(n.isError(wt))return wt;n=wt}var C=n.offset;if(v.use===null&&v.choice===null){if(v.any)var A=n.save();var _t=this._decodeTag(n,v.implicit!==null?v.implicit:v.tag,v.any);if(n.isError(_t))return _t;v.any?d=n.raw(A):n=_t}if(u&&u.track&&v.tag!==null&&u.track(n.path(),C,n.length,"tagged"),u&&u.track&&v.tag!==null&&u.track(n.path(),n.offset,n.length,"content"),v.any?d=d:v.choice===null?d=this._decodeGeneric(v.tag,n,u):d=this._decodeChoice(n,u),n.isError(d))return d;if(!v.any&&v.choice===null&&v.children!==null&&v.children.forEach(function(Et){Et._decode(n,u)}),v.contains&&(v.tag==="octstr"||v.tag==="bitstr")){var Bt=new D(d);d=this._getUse(v.contains,n._reporterState.obj)._decode(Bt,u)}}return v.obj&&M&&(d=n.leaveObject(O)),v.key!==null&&(d!==null||M===!0)?n.leaveKey(_,v.key,d):_!==null&&n.exitKey(_),d},w.prototype._decodeGeneric=function(n,u,v){var d=this._baseState;return n==="seq"||n==="set"?null:n==="seqof"||n==="setof"?this._decodeList(u,n,d.args[0],v):/str$/.test(n)?this._decodeStr(u,n,v):n==="objid"&&d.args?this._decodeObjid(u,d.args[0],d.args[1],v):n==="objid"?this._decodeObjid(u,null,null,v):n==="gentime"||n==="utctime"?this._decodeTime(u,n,v):n==="null_"?this._decodeNull(u,v):n==="bool"?this._decodeBool(u,v):n==="objDesc"?this._decodeStr(u,n,v):n==="int"||n==="enum"?this._decodeInt(u,d.args&&d.args[0],v):d.use!==null?this._getUse(d.use,u._reporterState.obj)._decode(u,v):u.error("unknown tag: "+n)},w.prototype._getUse=function(n,u){var v=this._baseState;return v.useDecoder=this._use(n,u),m(v.useDecoder._baseState.parent===null),v.useDecoder=v.useDecoder._baseState.children[0],v.implicit!==v.useDecoder._baseState.implicit&&(v.useDecoder=v.useDecoder.clone(),v.useDecoder._baseState.implicit=v.implicit),v.useDecoder},w.prototype._decodeChoice=function(n,u){var v=this._baseState,d=null,M=!1;return Object.keys(v.choice).some(function(_){var k=n.save(),A=v.choice[_];try{var O=A._decode(n,u);if(n.isError(O))return!1;d={type:_,value:O},M=!0}catch{return n.restore(k),!1}return!0},this),M?d:n.error("Choice not matched")},w.prototype._createEncoderBuffer=function(n){return new x(n,this.reporter)},w.prototype._encode=function(n,u,v){var d=this._baseState;if(!(d.default!==null&&d.default===n)){var M=this._encodeValue(n,u,v);if(M!==void 0&&!this._skipDefault(M,u,v))return M}},w.prototype._encodeValue=function(n,u,v){var d=this._baseState;if(d.parent===null)return d.children[0]._encode(n,u||new R);var A=null;if(this.reporter=u,d.optional&&n===void 0)if(d.default!==null)n=d.default;else return;var M=null,_=!1;if(d.any)A=this._createEncoderBuffer(n);else if(d.choice)A=this._encodeChoice(n,u);else if(d.contains)M=this._getUse(d.contains,v)._encode(n,u),_=!0;else if(d.children)M=d.children.map(function(C){if(C._baseState.tag==="null_")return C._encode(null,u,n);if(C._baseState.key===null)return u.error("Child should have a key");var _t=u.enterKey(C._baseState.key);if(typeof n!="object")return u.error("Child expected, but input is not object");var Bt=C._encode(n[C._baseState.key],u,n);return u.leaveKey(_t),Bt},this).filter(function(C){return C}),M=this._createEncoderBuffer(M);else if(d.tag==="seqof"||d.tag==="setof"){if(!(d.args&&d.args.length===1))return u.error("Too many args for : "+d.tag);if(!Array.isArray(n))return u.error("seqof/setof, but data is not Array");var k=this.clone();k._baseState.implicit=null,M=this._createEncoderBuffer(n.map(function(C){var _t=this._baseState;return this._getUse(_t.args[0],n)._encode(C,u)},k))}else d.use!==null?A=this._getUse(d.use,v)._encode(n,u):(M=this._encodePrimitive(d.tag,n),_=!0);var A;if(!d.any&&d.choice===null){var O=d.implicit!==null?d.implicit:d.tag,wt=d.implicit===null?"universal":"context";O===null?d.use===null&&u.error("Tag could be omitted only for .use()"):d.use===null&&(A=this._encodeComposite(O,_,wt,M))}return d.explicit!==null&&(A=this._encodeComposite(d.explicit,!1,"context",A)),A},w.prototype._encodeChoice=function(n,u){var v=this._baseState,d=v.choice[n.type];return d||m(!1,n.type+" not found in "+JSON.stringify(Object.keys(v.choice))),d._encode(n.value,u)},w.prototype._encodePrimitive=function(n,u){var v=this._baseState;if(/str$/.test(n))return this._encodeStr(u,n);if(n==="objid"&&v.args)return this._encodeObjid(u,v.reverseArgs[0],v.args[1]);if(n==="objid")return this._encodeObjid(u,null,null);if(n==="gentime"||n==="utctime")return this._encodeTime(u,n);if(n==="null_")return this._encodeNull();if(n==="int"||n==="enum")return this._encodeInt(u,v.args&&v.reverseArgs[0]);if(n==="bool")return this._encodeBool(u);if(n==="objDesc")return this._encodeStr(u,n);throw new Error("Unsupported tag: "+n)},w.prototype._isNumstr=function(n){return/^[0-9 ]*$/.test(n)},w.prototype._isPrintstr=function(n){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(n)},te}var Oe;function kt(){return Oe||(Oe=1,function(R){var x=R;x.Reporter=er().Reporter,x.DecoderBuffer=Te().DecoderBuffer,x.EncoderBuffer=Te().EncoderBuffer,x.Node=rr()}(Qt)),Qt}var ee={},re={},je;function ir(){return je||(je=1,function(R){var x=Fe();R.tagClass={0:"universal",1:"application",2:"context",3:"private"},R.tagClassByName=x._reverse(R.tagClass),R.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},R.tagByName=x._reverse(R.tag)}(re)),re}var Ie;function Fe(){return Ie||(Ie=1,function(R){var x=R;x._reverse=function(m){var b={};return Object.keys(m).forEach(function(a){(a|0)==a&&(a=a|0);var y=m[a];b[y]=a}),b},x.der=ir()}(ee)),ee}var ie={},ne,Ce;function Ge(){if(Ce)return ne;Ce=1;var R=St(),x=ue(),D=x.base,m=x.bignum,b=x.constants.der;function a(g){this.enc="der",this.name=g.name,this.entity=g,this.tree=new y,this.tree._init(g.body)}ne=a,a.prototype.decode=function(n,u){return n instanceof D.DecoderBuffer||(n=new D.DecoderBuffer(n,u)),this.tree._decode(n,u)};function y(g){D.Node.call(this,"der",g)}R(y,D.Node),y.prototype._peekTag=function(n,u,v){if(n.isEmpty())return!1;var d=n.save(),M=w(n,'Failed to peek tag: "'+u+'"');return n.isError(M)?M:(n.restore(d),M.tag===u||M.tagStr===u||M.tagStr+"of"===u||v)},y.prototype._decodeTag=function(n,u,v){var d=w(n,'Failed to decode tag of "'+u+'"');if(n.isError(d))return d;var M=T(n,d.primitive,'Failed to get length of "'+u+'"');if(n.isError(M))return M;if(!v&&d.tag!==u&&d.tagStr!==u&&d.tagStr+"of"!==u)return n.error('Failed to match tag: "'+u+'"');if(d.primitive||M!==null)return n.skip(M,'Failed to match body of: "'+u+'"');var _=n.save(),k=this._skipUntilEnd(n,'Failed to skip indefinite length body: "'+this.tag+'"');return n.isError(k)?k:(M=n.offset-_.offset,n.restore(_),n.skip(M,'Failed to match body of: "'+u+'"'))},y.prototype._skipUntilEnd=function(n,u){for(;;){var v=w(n,u);if(n.isError(v))return v;var d=T(n,v.primitive,u);if(n.isError(d))return d;var M;if(v.primitive||d!==null?M=n.skip(d):M=this._skipUntilEnd(n,u),n.isError(M))return M;if(v.tagStr==="end")break}},y.prototype._decodeList=function(n,u,v,d){for(var M=[];!n.isEmpty();){var _=this._peekTag(n,"end");if(n.isError(_))return _;var k=v.decode(n,"der",d);if(n.isError(k)&&_)break;M.push(k)}return M},y.prototype._decodeStr=function(n,u){if(u==="bitstr"){var v=n.readUInt8();return n.isError(v)?v:{unused:v,data:n.raw()}}else if(u==="bmpstr"){var d=n.raw();if(d.length%2===1)return n.error("Decoding of string type: bmpstr length mismatch");for(var M="",_=0;_<d.length/2;_++)M+=String.fromCharCode(d.readUInt16BE(_*2));return M}else if(u==="numstr"){var k=n.raw().toString("ascii");return this._isNumstr(k)?k:n.error("Decoding of string type: numstr unsupported characters")}else{if(u==="octstr")return n.raw();if(u==="objDesc")return n.raw();if(u==="printstr"){var A=n.raw().toString("ascii");return this._isPrintstr(A)?A:n.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(u)?n.raw().toString():n.error("Decoding of string type: "+u+" unsupported")}},y.prototype._decodeObjid=function(n,u,v){for(var d,M=[],_=0;!n.isEmpty();){var k=n.readUInt8();_<<=7,_|=k&127,(k&128)===0&&(M.push(_),_=0)}k&128&&M.push(_);var A=M[0]/40|0,O=M[0]%40;if(v?d=M:d=[A,O].concat(M.slice(1)),u){var wt=u[d.join(" ")];wt===void 0&&(wt=u[d.join(".")]),wt!==void 0&&(d=wt)}return d},y.prototype._decodeTime=function(n,u){var v=n.raw().toString();if(u==="gentime")var d=v.slice(0,4)|0,M=v.slice(4,6)|0,_=v.slice(6,8)|0,k=v.slice(8,10)|0,A=v.slice(10,12)|0,O=v.slice(12,14)|0;else if(u==="utctime"){var d=v.slice(0,2)|0,M=v.slice(2,4)|0,_=v.slice(4,6)|0,k=v.slice(6,8)|0,A=v.slice(8,10)|0,O=v.slice(10,12)|0;d<70?d=2e3+d:d=1900+d}else return n.error("Decoding "+u+" time is not supported yet");return Date.UTC(d,M-1,_,k,A,O,0)},y.prototype._decodeNull=function(n){return null},y.prototype._decodeBool=function(n){var u=n.readUInt8();return n.isError(u)?u:u!==0},y.prototype._decodeInt=function(n,u){var v=n.raw(),d=new m(v);return u&&(d=u[d.toString(10)]||d),d},y.prototype._use=function(n,u){return typeof n=="function"&&(n=n(u)),n._getDecoder("der").tree};function w(g,n){var u=g.readUInt8(n);if(g.isError(u))return u;var v=b.tagClass[u>>6],d=(u&32)===0;if((u&31)===31){var M=u;for(u=0;(M&128)===128;){if(M=g.readUInt8(n),g.isError(M))return M;u<<=7,u|=M&127}}else u&=31;var _=b.tag[u];return{cls:v,primitive:d,tag:u,tagStr:_}}function T(g,n,u){var v=g.readUInt8(u);if(g.isError(v))return v;if(!n&&v===128)return null;if((v&128)===0)return v;var d=v&127;if(d>4)return g.error("length octect is too long");v=0;for(var M=0;M<d;M++){v<<=8;var _=g.readUInt8(u);if(g.isError(_))return _;v|=_}return v}return ne}var oe,Ue;function nr(){if(Ue)return oe;Ue=1;var R=St(),x=ae().Buffer,D=Ge();function m(b){D.call(this,b),this.enc="pem"}return R(m,D),oe=m,m.prototype.decode=function(a,y){for(var w=a.toString().split(/[\r\n]+/g),T=y.label.toUpperCase(),g=/^-----(BEGIN|END) ([^-]+)-----$/,n=-1,u=-1,v=0;v<w.length;v++){var d=w[v].match(g);if(d!==null&&d[2]===T)if(n===-1){if(d[1]!=="BEGIN")break;n=v}else{if(d[1]!=="END")break;u=v;break}}if(n===-1||u===-1)throw new Error("PEM section not found for: "+T);var M=w.slice(n+1,u).join("");M.replace(/[^a-z0-9\+\/=]+/gi,"");var _=new x(M,"base64");return D.prototype.decode.call(this,_,y)},oe}var Ze;function or(){return Ze||(Ze=1,function(R){var x=R;x.der=Ge(),x.pem=nr()}(ie)),ie}var se={},he,Le;function He(){if(Le)return he;Le=1;var R=St(),x=ae().Buffer,D=ue(),m=D.base,b=D.constants.der;function a(g){this.enc="der",this.name=g.name,this.entity=g,this.tree=new y,this.tree._init(g.body)}he=a,a.prototype.encode=function(n,u){return this.tree._encode(n,u).join()};function y(g){m.Node.call(this,"der",g)}R(y,m.Node),y.prototype._encodeComposite=function(n,u,v,d){var M=T(n,u,v,this.reporter);if(d.length<128){var A=new x(2);return A[0]=M,A[1]=d.length,this._createEncoderBuffer([A,d])}for(var _=1,k=d.length;k>=256;k>>=8)_++;var A=new x(2+_);A[0]=M,A[1]=128|_;for(var k=1+_,O=d.length;O>0;k--,O>>=8)A[k]=O&255;return this._createEncoderBuffer([A,d])},y.prototype._encodeStr=function(n,u){if(u==="bitstr")return this._createEncoderBuffer([n.unused|0,n.data]);if(u==="bmpstr"){for(var v=new x(n.length*2),d=0;d<n.length;d++)v.writeUInt16BE(n.charCodeAt(d),d*2);return this._createEncoderBuffer(v)}else return u==="numstr"?this._isNumstr(n)?this._createEncoderBuffer(n):this.reporter.error("Encoding of string type: numstr supports only digits and space"):u==="printstr"?this._isPrintstr(n)?this._createEncoderBuffer(n):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(u)?this._createEncoderBuffer(n):u==="objDesc"?this._createEncoderBuffer(n):this.reporter.error("Encoding of string type: "+u+" unsupported")},y.prototype._encodeObjid=function(n,u,v){if(typeof n=="string"){if(!u)return this.reporter.error("string objid given, but no values map found");if(!u.hasOwnProperty(n))return this.reporter.error("objid not found in values map");n=u[n].split(/[\s\.]+/g);for(var d=0;d<n.length;d++)n[d]|=0}else if(Array.isArray(n)){n=n.slice();for(var d=0;d<n.length;d++)n[d]|=0}if(!Array.isArray(n))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(n));if(!v){if(n[1]>=40)return this.reporter.error("Second objid identifier OOB");n.splice(0,2,n[0]*40+n[1])}for(var M=0,d=0;d<n.length;d++){var _=n[d];for(M++;_>=128;_>>=7)M++}for(var k=new x(M),A=k.length-1,d=n.length-1;d>=0;d--){var _=n[d];for(k[A--]=_&127;(_>>=7)>0;)k[A--]=128|_&127}return this._createEncoderBuffer(k)};function w(g){return g<10?"0"+g:g}y.prototype._encodeTime=function(n,u){var v,d=new Date(n);return u==="gentime"?v=[w(d.getFullYear()),w(d.getUTCMonth()+1),w(d.getUTCDate()),w(d.getUTCHours()),w(d.getUTCMinutes()),w(d.getUTCSeconds()),"Z"].join(""):u==="utctime"?v=[w(d.getFullYear()%100),w(d.getUTCMonth()+1),w(d.getUTCDate()),w(d.getUTCHours()),w(d.getUTCMinutes()),w(d.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+u+" time is not supported yet"),this._encodeStr(v,"octstr")},y.prototype._encodeNull=function(){return this._createEncoderBuffer("")},y.prototype._encodeInt=function(n,u){if(typeof n=="string"){if(!u)return this.reporter.error("String int or enum given, but no values map");if(!u.hasOwnProperty(n))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(n));n=u[n]}if(typeof n!="number"&&!x.isBuffer(n)){var v=n.toArray();!n.sign&&v[0]&128&&v.unshift(0),n=new x(v)}if(x.isBuffer(n)){var d=n.length;n.length===0&&d++;var _=new x(d);return n.copy(_),n.length===0&&(_[0]=0),this._createEncoderBuffer(_)}if(n<128)return this._createEncoderBuffer(n);if(n<256)return this._createEncoderBuffer([0,n]);for(var d=1,M=n;M>=256;M>>=8)d++;for(var _=new Array(d),M=_.length-1;M>=0;M--)_[M]=n&255,n>>=8;return _[0]&128&&_.unshift(0),this._createEncoderBuffer(new x(_))},y.prototype._encodeBool=function(n){return this._createEncoderBuffer(n?255:0)},y.prototype._use=function(n,u){return typeof n=="function"&&(n=n(u)),n._getEncoder("der").tree},y.prototype._skipDefault=function(n,u,v){var d=this._baseState,M;if(d.default===null)return!1;var _=n.join();if(d.defaultBuffer===void 0&&(d.defaultBuffer=this._encodeValue(d.default,u,v).join()),_.length!==d.defaultBuffer.length)return!1;for(M=0;M<_.length;M++)if(_[M]!==d.defaultBuffer[M])return!1;return!0};function T(g,n,u,v){var d;if(g==="seqof"?g="seq":g==="setof"&&(g="set"),b.tagByName.hasOwnProperty(g))d=b.tagByName[g];else if(typeof g=="number"&&(g|0)===g)d=g;else return v.error("Unknown tag: "+g);return d>=31?v.error("Multi-octet tag encoding unsupported"):(n||(d|=32),d|=b.tagClassByName[u||"universal"]<<6,d)}return he}var fe,Pe;function sr(){if(Pe)return fe;Pe=1;var R=St(),x=He();function D(m){x.call(this,m),this.enc="pem"}return R(D,x),fe=D,D.prototype.encode=function(b,a){for(var y=x.prototype.encode.call(this,b),w=y.toString("base64"),T=["-----BEGIN "+a.label+"-----"],g=0;g<w.length;g+=64)T.push(w.slice(g,g+64));return T.push("-----END "+a.label+"-----"),T.join(`
`)},fe}var ze;function hr(){return ze||(ze=1,function(R){var x=R;x.der=He(),x.pem=sr()}(se)),se}var Ke;function ue(){return Ke||(Ke=1,function(R){var x=R;x.bignum=Xe(),x.define=tr().define,x.base=kt(),x.constants=Fe(),x.decoders=or(),x.encoders=hr()}(Yt)),Yt}export{ue as a,$e as r,Ye as z};
