import{r as z}from"./vendor-safe-buffer-BPihLaHX.js";import{p as X}from"./vendor-process-DXjpGiAn.js";import{a as j}from"./vendor-create-hash-BsmGkCgx.js";import{r as G}from"./vendor-ripemd160-B-g9_ZaO.js";import{r as J}from"./vendor-sha.js-C_Iv65sP.js";var q={},H,K;function N(){if(K)return H;K=1;var f=Math.pow(2,30)-1;return H=function(s,c){if(typeof s!="number")throw new TypeError("Iterations not a number");if(s<0)throw new TypeError("Bad iterations");if(typeof c!="number")throw new TypeError("Key length not a number");if(c<0||c>f||c!==c)throw new TypeError("Bad key length")},H}var R,F;function O(){if(F)return R;F=1;var f;if(globalThis.process&&globalThis.process.browser)f="utf-8";else if(globalThis.process&&globalThis.process.version){var s=parseInt(X.version.split(".")[0].slice(1),10);f=s>=6?"utf-8":"binary"}else f="utf-8";return R=f,R}var D,U;function V(){if(U)return D;U=1;var f=z().Buffer;return D=function(s,c,h){if(f.isBuffer(s))return s;if(typeof s=="string")return f.from(s,c);if(ArrayBuffer.isView(s))return f.from(s.buffer);throw new TypeError(h+" must be a string, a Buffer, a typed array or a DataView")},D}var x,L;function Z(){if(L)return x;L=1;var f=j(),s=G(),c=J(),h=z().Buffer,T=N(),b=O(),p=V(),S=h.alloc(128),d={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function w(t,o,n){var e=v(t),r=t==="sha512"||t==="sha384"?128:64;o.length>r?o=e(o):o.length<r&&(o=h.concat([o,S],r));for(var u=h.allocUnsafe(r+d[t]),a=h.allocUnsafe(r+d[t]),i=0;i<r;i++)u[i]=o[i]^54,a[i]=o[i]^92;var l=h.allocUnsafe(r+n+4);u.copy(l,0,0,r),this.ipad1=l,this.ipad2=u,this.opad=a,this.alg=t,this.blocksize=r,this.hash=e,this.size=d[t]}w.prototype.run=function(t,o){t.copy(o,this.blocksize);var n=this.hash(o);return n.copy(this.opad,this.blocksize),this.hash(this.opad)};function v(t){function o(e){return c(t).update(e).digest()}function n(e){return new s().update(e).digest()}return t==="rmd160"||t==="ripemd160"?n:t==="md5"?f:o}function B(t,o,n,e,r){T(n,e),t=p(t,b,"Password"),o=p(o,b,"Salt"),r=r||"sha1";var u=new w(r,t,o.length),a=h.allocUnsafe(e),i=h.allocUnsafe(o.length+4);o.copy(i,0,0,o.length);for(var l=0,m=d[r],E=Math.ceil(e/m),P=1;P<=E;P++){i.writeUInt32BE(P,o.length);for(var A=u.run(i,u.ipad1),g=A,I=1;I<n;I++){g=u.run(g,u.ipad2);for(var y=0;y<m;y++)A[y]^=g[y]}A.copy(a,l),l+=m}return a}return x=B,x}var M,_;function Q(){if(_)return M;_=1;var f=z().Buffer,s=N(),c=O(),h=Z(),T=V(),b,p=globalThis.crypto&&globalThis.crypto.subtle,S={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function w(n){if(globalThis.process&&!globalThis.process.browser||!p||!p.importKey||!p.deriveBits)return Promise.resolve(!1);if(d[n]!==void 0)return d[n];b=b||f.alloc(8);var e=t(b,b,10,128,n).then(function(){return!0}).catch(function(){return!1});return d[n]=e,e}var v;function B(){return v||(globalThis.process&&globalThis.process.nextTick?v=globalThis.process.nextTick:globalThis.queueMicrotask?v=globalThis.queueMicrotask:globalThis.setImmediate?v=globalThis.setImmediate:v=globalThis.setTimeout,v)}function t(n,e,r,u,a){return p.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits"]).then(function(i){return p.deriveBits({name:"PBKDF2",salt:e,iterations:r,hash:{name:a}},i,u<<3)}).then(function(i){return f.from(i)})}function o(n,e){n.then(function(r){B()(function(){e(null,r)})},function(r){B()(function(){e(r)})})}return M=function(n,e,r,u,a,i){typeof a=="function"&&(i=a,a=void 0),a=a||"sha1";var l=S[a.toLowerCase()];if(!l||typeof globalThis.Promise!="function"){B()(function(){var m;try{m=h(n,e,r,u,a)}catch(E){return i(E)}i(null,m)});return}if(s(r,u),n=T(n,c,"Password"),e=T(e,c,"Salt"),typeof i!="function")throw new Error("No callback provided to pbkdf2");o(w(l).then(function(m){return m?t(n,e,r,u,l):h(n,e,r,u,a)}),i)},M}var C;function er(){return C||(C=1,q.pbkdf2=Q(),q.pbkdf2Sync=Z()),q}export{er as r};
