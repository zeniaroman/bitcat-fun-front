"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[8327],{79710:function(t,e,a){a.d(e,{A:function(){return g}});var i=a(56768);const s={class:"cancel-modal"},n={class:"cancel-modal__box"},l={class:"cancel-modal__actions"},r=["disabled"],o={key:0,class:"cancel-modal__spinner"};function c(t,e,a,c,d,u){return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.Lk)("div",n,[e[4]||(e[4]=(0,i.Lk)("h3",{class:"cancel-modal__title"},"Cancel Listing",-1)),e[5]||(e[5]=(0,i.Lk)("p",{class:"cancel-modal__message"},"Are you sure you want to cancel this listing?",-1)),(0,i.Lk)("div",l,[(0,i.Lk)("button",{type:"button",class:"cancel-modal__button cancel-modal__button--secondary",onClick:e[0]||(e[0]=e=>t.$emit("close"))}," No, Keep Listing "),(0,i.Lk)("button",{onClick:e[1]||(e[1]=e=>t.$emit("confirm")),class:"cancel-modal__button cancel-modal__button--danger",disabled:a.isSubmitting},[a.isSubmitting?((0,i.uX)(),(0,i.CE)("span",o)):(0,i.Q3)("",!0),e[3]||(e[3]=(0,i.eW)(" Yes, Cancel Listing "))],8,r)])]),(0,i.Lk)("div",{class:"cancel-modal__backdrop",onClick:e[2]||(e[2]=e=>t.$emit("close"))})])}var d={name:"CancelListingModal",props:{isSubmitting:{type:Boolean,default:!1}}},u=a(71241);const m=(0,u.A)(d,[["render",c],["__scopeId","data-v-f36f194a"]]);var g=m},76241:function(t,e,a){a.d(e,{A:function(){return E}});var i=a(56768),s=a(24232),n=a(45130);const l={class:"bid-modal"},r={class:"bid-modal__box"},o={class:"bid-modal__nft-preview"},c={class:"bid-modal__nft-image-container"},d=["src","alt"],u={key:1,class:"bid-modal__nft-placeholder"},m={class:"bid-modal__nft-name"},g={class:"bid-modal__form-group"},_=["value"],f={class:"bid-modal__form-group"},b=["min"],k={class:"bid-modal__form-help"},p={class:"bid-modal__fee-summary"},L={class:"bid-modal__fee-row"},v={class:"bid-modal__fee-row bid-modal__fee-row--total"},h={class:"bid-modal__actions"},y=["disabled"],w={key:0,class:"bid-modal__spinner"};function C(t,e,a,C,A,P){return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("div",r,[e[11]||(e[11]=(0,i.Lk)("h3",{class:"bid-modal__title"},"Place Bid",-1)),(0,i.Lk)("div",o,[(0,i.Lk)("div",c,[a.listing.imageUrl?((0,i.uX)(),(0,i.CE)("img",{key:0,src:a.listing.imageUrl,alt:a.listing.name,class:"bid-modal__nft-image"},null,8,d)):((0,i.uX)(),(0,i.CE)("div",u,e[4]||(e[4]=[(0,i.Lk)("i",{class:"fas fa-image bid-modal__nft-placeholder-icon"},null,-1)])))]),(0,i.Lk)("h4",m,(0,s.v_)(a.listing.name||`NFT #${a.listing.mintAddress.substring(0,8)}`),1)]),(0,i.Lk)("form",{onSubmit:e[2]||(e[2]=(0,n.D$)(((...t)=>P.submitBid&&P.submitBid(...t)),["prevent"])),class:"bid-modal__form"},[(0,i.Lk)("div",g,[e[5]||(e[5]=(0,i.Lk)("label",{class:"bid-modal__form-label"},[(0,i.Lk)("span",{class:"bid-modal__form-label-text"},"Current Price")],-1)),(0,i.Lk)("input",{value:P.formatPrice(a.listing.highestBid||a.listing.initialPrice),type:"text",class:"bid-modal__form-input bid-modal__form-input--disabled",disabled:""},null,8,_)]),(0,i.Lk)("div",f,[e[6]||(e[6]=(0,i.Lk)("label",{class:"bid-modal__form-label"},[(0,i.Lk)("span",{class:"bid-modal__form-label-text"},"Your Bid (SOL)")],-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>A.bidAmount=t),type:"number",step:"0.01",min:P.minBidAmount,placeholder:"Enter bid amount",class:"bid-modal__form-input",required:""},null,8,b),[[n.Jo,A.bidAmount]]),(0,i.Lk)("span",k,"Minimum bid: "+(0,s.v_)(P.minBidAmount)+" SOL",1)]),(0,i.Lk)("div",p,[e[9]||(e[9]=(0,i.Lk)("h4",{class:"bid-modal__fee-title"},"Fees",-1)),(0,i.Lk)("div",L,[e[7]||(e[7]=(0,i.Lk)("span",null,"Marketplace Fee (5%)",-1)),(0,i.Lk)("span",null,(0,s.v_)(P.calculateFee())+" SOL",1)]),(0,i.Lk)("div",v,[e[8]||(e[8]=(0,i.Lk)("span",null,"Total",-1)),(0,i.Lk)("span",null,(0,s.v_)(P.calculateTotal())+" SOL",1)])]),(0,i.Lk)("div",h,[(0,i.Lk)("button",{type:"button",class:"bid-modal__button bid-modal__button--cancel",onClick:e[1]||(e[1]=e=>t.$emit("close"))},"Cancel"),(0,i.Lk)("button",{type:"submit",class:"bid-modal__button bid-modal__button--submit",disabled:a.isSubmitting||!P.isFormValid},[a.isSubmitting?((0,i.uX)(),(0,i.CE)("span",w)):(0,i.Q3)("",!0),e[10]||(e[10]=(0,i.eW)(" Place Bid "))],8,y)])],32)]),(0,i.Lk)("div",{class:"bid-modal__backdrop",onClick:e[3]||(e[3]=e=>t.$emit("close"))})])}var A={name:"PlaceBidModal",props:{listing:{type:Object,required:!0},isSubmitting:{type:Boolean,default:!1}},data(){return{bidAmount:""}},computed:{minBidAmount(){const t=this.listing.highestBid||this.listing.initialPrice;return(parseFloat(t)+.01).toFixed(2)},isFormValid(){return this.bidAmount&&parseFloat(this.bidAmount)>=parseFloat(this.minBidAmount)}},methods:{formatPrice(t){return parseFloat(t).toFixed(3)},calculateFee(){if(!this.bidAmount)return"0";const t=.05*parseFloat(this.bidAmount);return t.toFixed(3)},calculateTotal(){if(!this.bidAmount)return"0";const t=parseFloat(this.bidAmount),e=.05*t;return(t+e).toFixed(3)},submitBid(){this.isFormValid&&this.$emit("submit",{mintAddress:this.listing.mintAddress,amount:parseFloat(this.bidAmount)})}},mounted(){this.bidAmount=this.minBidAmount}},P=a(71241);const F=(0,P.A)(A,[["render",C],["__scopeId","data-v-fe5ce5c6"]]);var E=F},18327:function(t,e,a){a.r(e),a.d(e,{default:function(){return Bt}});var i=a(56768),s=a(24232);const n={class:"nft-market"},l={class:"nft-market__container"},r={key:0,class:"nft-market__create-section"},o={class:"nft-market__listings-section"},c={class:"nft-market__listings-header"},d={class:"nft-market__listings-controls"},u=["disabled"],m={key:0,class:"nft-market__tab-buttons"},g={key:0,class:"nft-market__loader-container"},_={key:1,class:"nft-market__empty-state"},f={key:0,class:"nft-market__empty-subtitle"},b={key:1,class:"nft-market__empty-subtitle"},k={key:2,class:"nft-market__listings-grid"};function p(t,e,a,p,L,v){const h=(0,i.g2)("NftListingCard"),y=(0,i.g2)("CreateListingModal"),w=(0,i.g2)("PlaceBidModal"),C=(0,i.g2)("CancelListingModal");return(0,i.uX)(),(0,i.CE)("div",n,[(0,i.Lk)("div",l,[e[13]||(e[13]=(0,i.Lk)("h1",{class:"nft-market__title"},"NFT Marketplace",-1)),v.hasWallet?((0,i.uX)(),(0,i.CE)("div",r,[e[7]||(e[7]=(0,i.Lk)("h2",{class:"nft-market__section-title"},"Sell Your NFT",-1)),e[8]||(e[8]=(0,i.Lk)("p",{class:"nft-market__section-description"},"List your NFT for sale on our marketplace and earn SOL.",-1)),(0,i.Lk)("button",{onClick:e[0]||(e[0]=t=>p.showCreateListingModal=!0),class:"nft-market__create-button"}," Create Listing ")])):(0,i.Q3)("",!0),(0,i.Lk)("div",o,[(0,i.Lk)("div",c,[e[10]||(e[10]=(0,i.Lk)("h2",{class:"nft-market__section-title"},"Active Listings",-1)),(0,i.Lk)("div",d,[(0,i.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>p.loadListings&&p.loadListings(...t)),class:"nft-market__refresh-button",disabled:p.isLoading},e[9]||(e[9]=[(0,i.Lk)("i",{class:"fas fa-sync-alt nft-market__refresh-icon"},null,-1),(0,i.eW)(" Refresh ")]),8,u),v.hasWallet?((0,i.uX)(),(0,i.CE)("div",m,[(0,i.Lk)("button",{onClick:e[2]||(e[2]=t=>p.activeTab="all"),class:(0,s.C4)(["nft-market__tab-button",{"nft-market__tab-button--active":"all"===p.activeTab}])}," All ",2),(0,i.Lk)("button",{onClick:e[3]||(e[3]=t=>p.activeTab="my"),class:(0,s.C4)(["nft-market__tab-button",{"nft-market__tab-button--active":"my"===p.activeTab}])}," My Listings ",2)])):(0,i.Q3)("",!0)])]),p.isLoading?((0,i.uX)(),(0,i.CE)("div",g,e[11]||(e[11]=[(0,i.Lk)("div",{class:"nft-market__loader"},null,-1)]))):0===p.displayedListings.length?((0,i.uX)(),(0,i.CE)("div",_,[e[12]||(e[12]=(0,i.Lk)("p",{class:"nft-market__empty-title"},"No NFT listings found.",-1)),"my"===p.activeTab?((0,i.uX)(),(0,i.CE)("p",f," You haven't listed any NFTs for sale yet. ")):((0,i.uX)(),(0,i.CE)("p",b," Be the first to list your NFT on our marketplace! "))])):((0,i.uX)(),(0,i.CE)("div",k,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.displayedListings,(t=>((0,i.uX)(),(0,i.Wv)(h,{key:t.id,listing:t,"wallet-address":p.walletAddress,connected:v.hasWallet,onView:p.viewListing,onBid:p.placeBid,onCancel:p.cancelListing},null,8,["listing","wallet-address","connected","onView","onBid","onCancel"])))),128))]))])]),p.showCreateListingModal?((0,i.uX)(),(0,i.Wv)(y,{key:0,"user-nfts":p.userNfts,"is-loading":p.isLoadingUserNfts,"is-submitting":p.isCreatingListing,onClose:e[4]||(e[4]=t=>p.showCreateListingModal=!1),onSubmit:p.handleCreateListing},null,8,["user-nfts","is-loading","is-submitting","onSubmit"])):(0,i.Q3)("",!0),p.showBidModal&&p.selectedListing?((0,i.uX)(),(0,i.Wv)(w,{key:1,listing:p.selectedListing,"is-submitting":p.isPlacingBid,onClose:e[5]||(e[5]=t=>p.showBidModal=!1),onSubmit:p.handlePlaceBid},null,8,["listing","is-submitting","onSubmit"])):(0,i.Q3)("",!0),p.showCancelModal&&p.selectedListing?((0,i.uX)(),(0,i.Wv)(C,{key:2,"is-submitting":p.isCancelling,onClose:e[6]||(e[6]=t=>p.showCancelModal=!1),onConfirm:p.handleCancelListing},null,8,["is-submitting","onConfirm"])):(0,i.Q3)("",!0)])}a(44114),a(98992),a(3949),a(81454);var L=a(90144),v=a(86659),h=a(81387),y=a(4249),w=a(94373),C=a(75290),A=a(96529),P=a(56675),F=a(63410),E=a(22123);const N={class:"nft-card"},T={class:"nft-card__image-container"},B=["src","alt"],S={key:1,class:"nft-card__image-placeholder"},M={class:"nft-card__content"},X={class:"nft-card__title"},K={class:"nft-card__address"},$={key:0,class:"nft-card__seller"},W={class:"nft-card__seller-value"},D={class:"nft-card__price-container"},U={class:"nft-card__price-block"},R={class:"nft-card__price-value"},x={key:0,class:"nft-card__price-block"},O={class:"nft-card__price-value"},V={class:"nft-card__time-block"},H={class:"nft-card__time-value"},I={class:"nft-card__actions"};function Q(t,e,a,n,l,r){return(0,i.uX)(),(0,i.CE)("div",N,[(0,i.Lk)("div",T,[a.listing.imageUrl?((0,i.uX)(),(0,i.CE)("img",{key:0,src:a.listing.imageUrl,alt:a.listing.name,class:"nft-card__image"},null,8,B)):((0,i.uX)(),(0,i.CE)("div",S,e[3]||(e[3]=[(0,i.Lk)("i",{class:"fas fa-image nft-card__placeholder-icon"},null,-1)]))),"active"!==a.listing.status?((0,i.uX)(),(0,i.CE)("div",{key:2,class:(0,s.C4)(["nft-card__status",{"nft-card__status--sold":"sold"===a.listing.status,"nft-card__status--cancelled":"cancelled"===a.listing.status,"nft-card__status--expired":"expired"===a.listing.status}])},(0,s.v_)(a.listing.status),3)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",M,[(0,i.Lk)("h3",X,(0,s.v_)(a.listing.name||`NFT #${a.listing.mintAddress.substring(0,8)}`),1),(0,i.Lk)("p",K,(0,s.v_)(r.shortenAddress(a.listing.mintAddress)),1),a.listing.userTag?((0,i.uX)(),(0,i.CE)("div",$,[e[4]||(e[4]=(0,i.Lk)("p",{class:"nft-card__seller-label"},"Seller:",-1)),(0,i.Lk)("p",W,(0,s.v_)(a.listing.userTag),1)])):(0,i.Q3)("",!0),(0,i.Lk)("div",D,[(0,i.Lk)("div",U,[e[5]||(e[5]=(0,i.Lk)("p",{class:"nft-card__price-label"},"Price",-1)),(0,i.Lk)("p",R,(0,s.v_)(r.formatPrice(a.listing.initialPrice))+" SOL",1)]),a.listing.instantPrice?((0,i.uX)(),(0,i.CE)("div",x,[e[6]||(e[6]=(0,i.Lk)("p",{class:"nft-card__price-label"},"Buy Now",-1)),(0,i.Lk)("p",O,(0,s.v_)(r.formatPrice(a.listing.instantPrice))+" SOL",1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",V,[e[7]||(e[7]=(0,i.Lk)("p",{class:"nft-card__time-label"},"Ends in",-1)),(0,i.Lk)("p",H,(0,s.v_)(r.formatTimeRemaining(a.listing.endTime)),1)]),(0,i.Lk)("div",I,[(0,i.Lk)("button",{onClick:e[0]||(e[0]=e=>t.$emit("view",a.listing)),class:"nft-card__button nft-card__button--view"}," View Details "),r.canBid?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:e[1]||(e[1]=e=>t.$emit("bid",a.listing)),class:"nft-card__button nft-card__button--bid"}," Place Bid ")):(0,i.Q3)("",!0),r.canCancel?((0,i.uX)(),(0,i.CE)("button",{key:1,onClick:e[2]||(e[2]=e=>t.$emit("cancel",a.listing)),class:"nft-card__button nft-card__button--cancel"}," Cancel ")):(0,i.Q3)("",!0)])])])}var Y={name:"NftListingCard",props:{listing:{type:Object,required:!0},walletAddress:{type:String,default:""},connected:{type:Boolean,default:!1}},computed:{canBid(){return this.connected&&"active"===this.listing.status&&this.listing.sellerWallet!==this.walletAddress},canCancel(){return this.connected&&"active"===this.listing.status&&this.listing.sellerWallet===this.walletAddress}},methods:{formatPrice(t){return parseFloat(t).toFixed(3)},formatTimeRemaining(t){const e=new Date(t),a=new Date;if(e<=a)return"Ended";const i=e-a,s=Math.floor(i/864e5),n=Math.floor(i%864e5/36e5),l=Math.floor(i%36e5/6e4);return s>0?`${s}d ${n}h`:n>0?`${n}h ${l}m`:`${l}m`},shortenAddress(t){return t?`${t.substring(0,4)}...${t.substring(t.length-4)}`:""}}},j=a(71241);const q=(0,j.A)(Y,[["render",Q],["__scopeId","data-v-552b1876"]]);var J=q,z=a(45130);const G={class:"create-listing-modal"},Z={class:"create-listing-modal__box"},tt={key:0,class:"create-listing-modal__loader-container"},et={key:1,class:"create-listing-modal__empty"},at={key:2},it={class:"create-listing-modal__section"},st={class:"create-listing-modal__nft-grid"},nt=["onClick"],lt={class:"create-listing-modal__nft-image-container"},rt=["src","alt"],ot={key:1,class:"create-listing-modal__nft-placeholder"},ct={class:"create-listing-modal__nft-info"},dt={class:"create-listing-modal__nft-name"},ut={class:"create-listing-modal__form"},mt={class:"create-listing-modal__form-group"},gt={class:"create-listing-modal__form-group"},_t={class:"create-listing-modal__form-group"},ft=["min"],bt={class:"create-listing-modal__fee-summary"},kt={class:"create-listing-modal__fee-row"},pt={class:"create-listing-modal__fee-row create-listing-modal__fee-row--total"},Lt={class:"create-listing-modal__button-group"},vt=["disabled"];function ht(t,e,a,n,l,r){return(0,i.uX)(),(0,i.CE)("div",G,[(0,i.Lk)("div",Z,[e[19]||(e[19]=(0,i.Lk)("h3",{class:"create-listing-modal__title"},"Create NFT Listing",-1)),a.isLoading?((0,i.uX)(),(0,i.CE)("div",tt,e[6]||(e[6]=[(0,i.Lk)("div",{class:"create-listing-modal__loader"},null,-1)]))):0===a.userNfts.length?((0,i.uX)(),(0,i.CE)("div",et,e[7]||(e[7]=[(0,i.Lk)("p",{class:"create-listing-modal__empty-title"},"You don't have any NFTs to list.",-1),(0,i.Lk)("p",{class:"create-listing-modal__empty-subtitle"},"Mint or acquire NFTs first before creating a listing.",-1)]))):((0,i.uX)(),(0,i.CE)("div",at,[(0,i.Lk)("div",it,[e[9]||(e[9]=(0,i.Lk)("label",{class:"create-listing-modal__label"},"Select NFT",-1)),(0,i.Lk)("div",st,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.userNfts,(t=>((0,i.uX)(),(0,i.CE)("div",{key:t.mintAddress,onClick:e=>r.selectNft(t),class:(0,s.C4)(["create-listing-modal__nft-item",{"create-listing-modal__nft-item--selected":l.selectedNft&&l.selectedNft.mintAddress===t.mintAddress}])},[(0,i.Lk)("div",lt,[t.imageUrl?((0,i.uX)(),(0,i.CE)("img",{key:0,src:t.imageUrl,alt:t.name,class:"create-listing-modal__nft-image"},null,8,rt)):((0,i.uX)(),(0,i.CE)("div",ot,e[8]||(e[8]=[(0,i.Lk)("i",{class:"fas fa-image create-listing-modal__nft-placeholder-icon"},null,-1)])))]),(0,i.Lk)("div",ct,[(0,i.Lk)("p",dt,(0,s.v_)(t.name||`NFT #${t.mintAddress.substring(0,8)}`),1)])],10,nt)))),128))])]),(0,i.Lk)("div",ut,[(0,i.Lk)("div",mt,[e[10]||(e[10]=(0,i.Lk)("label",{class:"create-listing-modal__form-label"},[(0,i.Lk)("span",{class:"create-listing-modal__form-label-text"},"Initial Price (SOL)")],-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>l.form.initialPrice=t),type:"number",step:"0.01",min:"0.01",placeholder:"Enter initial price",class:"create-listing-modal__form-input",required:""},null,512),[[z.Jo,l.form.initialPrice]]),e[11]||(e[11]=(0,i.Lk)("span",{class:"create-listing-modal__form-help"},"Minimum price for the auction",-1))]),(0,i.Lk)("div",gt,[e[12]||(e[12]=(0,i.Lk)("label",{class:"create-listing-modal__form-label"},[(0,i.Lk)("span",{class:"create-listing-modal__form-label-text"},"Instant Buy Price (SOL, optional)")],-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>l.form.instantPrice=t),type:"number",step:"0.01",min:"0",placeholder:"Enter instant buy price (optional)",class:"create-listing-modal__form-input"},null,512),[[z.Jo,l.form.instantPrice]]),e[13]||(e[13]=(0,i.Lk)("span",{class:"create-listing-modal__form-help"},"Price for immediate purchase",-1))]),(0,i.Lk)("div",_t,[e[14]||(e[14]=(0,i.Lk)("label",{class:"create-listing-modal__form-label"},[(0,i.Lk)("span",{class:"create-listing-modal__form-label-text"},"End Date")],-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>l.form.endDate=t),type:"datetime-local",class:"create-listing-modal__form-input",required:"",min:r.minEndDate},null,8,ft),[[z.Jo,l.form.endDate]]),e[15]||(e[15]=(0,i.Lk)("span",{class:"create-listing-modal__form-help"},"When the auction will end",-1))]),(0,i.Lk)("div",bt,[e[18]||(e[18]=(0,i.Lk)("h4",{class:"create-listing-modal__fee-title"},"Fees",-1)),(0,i.Lk)("div",kt,[e[16]||(e[16]=(0,i.Lk)("span",null,"Marketplace Fee (5%)",-1)),(0,i.Lk)("span",null,(0,s.v_)(r.calculateFee())+" SOL",1)]),(0,i.Lk)("div",pt,[e[17]||(e[17]=(0,i.Lk)("span",null,"You will receive",-1)),(0,i.Lk)("span",null,(0,s.v_)(r.calculateReceived())+" SOL",1)])]),(0,i.Lk)("div",Lt,[(0,i.Lk)("button",{type:"button",onClick:e[3]||(e[3]=e=>t.$emit("close")),class:"create-listing-modal__button create-listing-modal__button--cancel"}," Cancel "),(0,i.Lk)("button",{type:"button",onClick:e[4]||(e[4]=(...t)=>r.createListingManually&&r.createListingManually(...t)),class:"create-listing-modal__button create-listing-modal__button--submit",disabled:!r.isFormValid||a.isSubmitting},(0,s.v_)(a.isSubmitting?"Creating...":"Create Listing"),9,vt)])])]))]),(0,i.Lk)("div",{class:"create-listing-modal__backdrop",onClick:e[5]||(e[5]=e=>t.$emit("close"))})])}var yt=a(94348),wt={name:"CreateListingModal",props:{userNfts:{type:Array,required:!0},isLoading:{type:Boolean,default:!1},isSubmitting:{type:Boolean,default:!1}},data(){return{selectedNft:null,form:{initialPrice:"",instantPrice:"",endDate:""}}},computed:{minEndDate(){const t=new Date;return t.setHours(t.getHours()+1),t.toISOString().slice(0,16)},isFormValid(){return this.selectedNft&&this.form.initialPrice>0&&this.form.endDate&&new Date(this.form.endDate)>new Date}},methods:{selectNft(t){yt.log("Selecting NFT:",t),t&&t.mintAddress?(this.selectedNft=t,yt.log("Selected NFT:",this.selectedNft)):yt.error("Invalid NFT selected:",t)},calculateFee(){if(!this.form.initialPrice)return"0";const t=.05*parseFloat(this.form.initialPrice);return t.toFixed(3)},calculateReceived(){if(!this.form.initialPrice)return"0";const t=parseFloat(this.form.initialPrice),e=.05*t;return(t-e).toFixed(3)},createListingManually(){if(!this.isFormValid)return;yt.log("Creating listing for NFT:",this.selectedNft);const t={mintAddress:this.selectedNft.mintAddress,name:this.selectedNft.name||"",imageUrl:this.selectedNft.imageUrl||"",metadataUri:this.selectedNft.metadataUri||""};yt.log("Sending NFT data to parent:",t),this.$emit("submit",{nft:t,initialPrice:parseFloat(this.form.initialPrice),instantPrice:this.form.instantPrice?parseFloat(this.form.instantPrice):null,endDate:this.form.endDate})}}};const Ct=(0,j.A)(wt,[["render",ht],["__scopeId","data-v-93970504"]]);var At=Ct,Pt=a(76241),Ft=a(79710),Et=a(94348),Nt={name:"NftMarketPage",components:{NftListingCard:J,CreateListingModal:At,PlaceBidModal:Pt.A,CancelListingModal:Ft.A},computed:{hasWallet(){return this.$store.getters.hasWallet}},setup(){const t=(0,h.rd)(),e=(0,y.Pj)(),{wallet:s,connected:n,publicKey:l}=(0,v.vT)(),r=(0,L.KR)([]),o=(0,L.KR)([]),c=(0,L.KR)([]),d=(0,L.KR)(null),u=(0,L.KR)(!1),m=(0,L.KR)(!1),g=(0,L.KR)(!1),_=(0,L.KR)(!1),f=(0,L.KR)(!1),b=(0,L.KR)("all"),k=(0,L.KR)(!1),p=(0,L.KR)(!1),N=(0,L.KR)(!1),T=(0,i.EW)((()=>l.value?.toBase58())),B=(0,i.EW)((()=>"my"===b.value?o.value:r.value)),S=()=>{const t=new C.Connection("https://sleek-icy-frog.solana-mainnet.quiknode.pro/9d4845e2d4c60caf45dc4f10d0bdcfdbcd6a321c");if(!e.getters.hasWallet)throw new Error("Wallet not connected");if(!window.solana)throw new Error("Phantom wallet not installed");const a={publicKey:l.value,signTransaction:async t=>{if(!window.solana)throw new Error("Phantom wallet not installed");return await window.solana.signTransaction(t)},signAllTransactions:async t=>{if(!window.solana)throw new Error("Phantom wallet not installed");return await window.solana.signAllTransactions(t)},signMessage:async t=>{if(!window.solana)throw new Error("Phantom wallet not installed");return await window.solana.signMessage(t)}};return A.X.make(t).use((0,P.H)(a)).use((0,F.W)())},M=async()=>{const t=S();return await t.auctionHouse().findByAddress({address:new C.PublicKey("G26L5YGdj9PaYuePz2jj7Qez2S3PJ39xGEKbAnoYHfVE")})},X=async()=>{try{u.value=!0;const t=await w.A.get("/nft-market/listings");r.value=t.data.data}catch(t){Et.error("Error loading listings:",t)}finally{u.value=!1}},K=async()=>{if(e.getters.hasWallet)try{const t=await w.A.get("/nft-market/listings/my");o.value=t.data.data}catch(t){Et.error("Error loading my listings:",t)}},$=async()=>{if(e.getters.hasWallet)try{m.value=!0;const t=await w.A.get("/nft-market/my-nfts");c.value=t.data.data.map((t=>({mintAddress:t.assetPublicKey,imageUrl:t.imageUri,name:t.name,id:t.id})))}catch(t){Et.error("Error loading user NFTs:",t),c.value=[]}finally{m.value=!1}},W=e=>{t.push(`/nft-market/listing/${e.mintAddress}`)},D=t=>{d.value=t,p.value=!0},U=t=>{d.value=t,N.value=!0},R=async t=>{try{if(g.value=!0,!e.getters.hasWallet)return alert("Please connect your wallet first."),void(g.value=!1);const n=parseFloat(t.initialPrice);Et.log(`Creating listing for NFT: ${t.nft.mintAddress} at ${n} SOL`);try{const e=S(),s=e.connection,r=await M(),o=l.value;Et.log("Creating listing using Metaplex SDK..."),Et.log(t.nft.mintAddress);const c=await e.nfts().findAllByOwner({owner:e.identity().publicKey});Et.log("NFT found:",c);try{const{listing:a,confirmResponse:i}=await e.auctionHouse().list({auctionHouse:r,mintAccount:new C.PublicKey(t.nft.mintAddress),price:(0,E.jN)(n),token:1,tokenAccount:new C.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),printReceipt:!0});Et.log("Listing created successfully:",a),Et.log("Transaction confirmed with signature:",i.signature),Et.log("Creating listing record in database...");const s=await w.A.post("/nft-market/listings",{mintAddress:t.nft.mintAddress,initialPrice:n,instantPrice:t.instantPrice,endTime:new Date(t.endDate).toISOString(),transactionSignature:i.signature});s.data.success?(Et.log("Listing created successfully in database:",s.data),k.value=!1,await X(),await K()):(Et.error("Error creating listing in database:",s.data),alert("Failed to create listing in database: "+s.data.message))}catch(i){Et.error("Error using Metaplex SDK:",i),Et.log("Building transaction manually using instructions...");const l=await e.auctionHouse().builders().list({auctionHouse:r,mintAccount:new C.PublicKey(t.nft.mintAddress),price:(0,E.jN)(n)}).getInstructions(),{Transaction:c}=await Promise.resolve().then(a.bind(a,75290)),d=new c;l.forEach((t=>d.add(t)));const{blockhash:u,lastValidBlockHeight:m}=await s.getLatestBlockhash();if(d.recentBlockhash=u,d.feePayer=o,Et.log("Transaction built, sending to Phantom for signing..."),!window.solana)throw new Error("Phantom wallet not installed");const g=await window.solana.signTransaction(d),_=await s.sendRawTransaction(g.serialize(),{skipPreflight:!1});Et.log("Transaction sent with signature:",_);const f=await s.confirmTransaction({signature:_,blockhash:u,lastValidBlockHeight:m});if(f.value&&f.value.err)throw new Error(`Transaction failed: ${f.value.err}`);Et.log("Transaction confirmed successfully"),Et.log("Creating listing record in database...");const b=await w.A.post("/nft-market/listings",{mintAddress:t.nft.mintAddress,initialPrice:n,instantPrice:t.instantPrice,endTime:new Date(t.endDate).toISOString(),transactionSignature:_});b.data.success?(Et.log("Listing created successfully in database:",b.data),k.value=!1,await X(),await K()):(Et.error("Error creating listing in database:",b.data),alert("Failed to create listing in database: "+b.data.message))}}catch(s){Et.error("Failed to create listing:",s);const t=s.message||"Unknown error";Et.error("Error details:",t),t.includes("AccountNotInitialized")?alert("Ошибка листинга NFT: Аккаунт не инициализирован. Убедитесь, что NFT действительно принадлежит вам."):alert("Не удалось создать листинг: "+t)}}catch(n){Et.error("Error creating listing:",n),alert("Failed to create listing. Please try again: "+(n.message||"Unknown error"))}finally{g.value=!1}},x=async t=>{try{if(_.value=!0,!e.getters.hasWallet)return alert("Please connect your wallet first."),void(_.value=!1);const i=parseFloat(t.amount);Et.log(`Placing bid for NFT: ${t.mintAddress} at ${i} SOL`);try{Et.log("Creating bid via Metaplex SDK...");const e=S(),a=await M(),{bid:s,confirmResponse:n}=await e.auctionHouse().bid({auctionHouse:a,mintAccount:new C.PublicKey(t.mintAddress),price:i});Et.log("Bid created successfully:",s),Et.log("Transaction confirmed with signature:",n.signature),Et.log("Recording bid in database...");const l=await w.A.post("/nft-market/bid",{mintAddress:t.mintAddress,bidAmount:i,transactionSignature:n.signature});l.data.success?(Et.log("Bid recorded successfully in database:",l.data),p.value=!1,d.value=null,await X(),await K()):(Et.error("Error recording bid in database:",l.data),alert("Failed to record bid in database. Please try again."))}catch(a){Et.error("Error placing bid:",a),alert("Failed to place bid. Please try again: "+(a.message||"Unknown error"))}finally{_.value=!1}}catch(a){Et.error("Error placing bid:",a),alert("Failed to place bid. Please try again: "+(a.message||"Unknown error"))}finally{_.value=!1}},O=async()=>{try{if(f.value=!0,!d.value)return alert("No listing selected."),void(f.value=!1);if(!e.getters.hasWallet)return alert("Please connect your wallet first."),void(f.value=!1);const t=d.value;Et.log(`Cancelling listing for NFT: ${t.mintAddress}`);const a=S(),i=await M(),{confirmResponse:s}=await a.auctionHouse().cancelListing({auctionHouse:i,listing:{price:parseFloat(t.initialPrice),mintAccount:new C.PublicKey(t.mintAddress),seller:l.value}});Et.log("Listing cancelled successfully with signature:",s.signature),Et.log("Updating listing status in database...");const n=await w.A.post("/nft-market/listings/cancel",{mintAddress:t.mintAddress,transactionSignature:s.signature});n.data.success?(Et.log("Listing cancelled successfully in database:",n.data),N.value=!1,d.value=null,await X(),await K()):(Et.error("Error cancelling listing in database:",n.data),alert("Failed to cancel listing in database. Please try again."))}catch(t){Et.error("Error cancelling listing:",t),alert("Failed to cancel listing. Please try again: "+(t.message||"Unknown error"))}finally{f.value=!1}};return(0,i.sV)((async()=>{await X()})),(0,i.wB)(n,(async t=>{t?await K():(o.value=[],b.value="all")})),(0,i.wB)(k,(async t=>{t&&await $()})),{wallet:s,connected:n,walletAddress:T,listings:r,myListings:o,userNfts:c,selectedListing:d,isLoading:u,isLoadingUserNfts:m,isCreatingListing:g,isPlacingBid:_,isCancelling:f,activeTab:b,showCreateListingModal:k,showBidModal:p,showCancelModal:N,displayedListings:B,loadListings:X,loadMyListings:K,loadUserNfts:$,viewListing:W,placeBid:D,cancelListing:U,handleCreateListing:R,handlePlaceBid:x,handleCancelListing:O}}};const Tt=(0,j.A)(Nt,[["render",p],["__scopeId","data-v-275d6b5e"]]);var Bt=Tt}}]);
//# sourceMappingURL=8327.de497d9d.js.map